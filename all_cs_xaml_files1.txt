============================================= 
Merged Source Files - Mon 02/16/2026  9:58:38.13 
Excluded: bin, obj, Migrations folders 
============================================= 
 
 
==================== Program.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\ 
 
﻿using Microsoft.AspNetCore.Authentication.JwtBearer;
using Microsoft.EntityFrameworkCore;
using Microsoft.IdentityModel.Tokens;
using OrganizationalMessenger.Application.Interfaces;
using OrganizationalMessenger.Infrastructure.Authentication;
using OrganizationalMessenger.Infrastructure.Data;
using OrganizationalMessenger.Infrastructure.Services;
using System.Text;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container
builder.Services.AddControllers();
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

// Database
builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

// Authentication Services
builder.Services.AddScoped<IAuthenticationProvider, ActiveDirectoryProvider>();
builder.Services.AddScoped<ErpAuthenticationProvider>();
builder.Services.AddScoped<OtpAuthenticationProvider>();
builder.Services.AddScoped<IAuthenticationManager, AuthenticationManager>();
builder.Services.AddScoped<ISmsService, SmsService>();

// HTTP Client
builder.Services.AddHttpClient();

// JWT Authentication
var jwtKey = builder.Configuration["Jwt:Key"] ?? throw new InvalidOperationException("JWT Key not configured");
var jwtIssuer = builder.Configuration["Jwt:Issuer"] ?? throw new InvalidOperationException("JWT Issuer not configured");
var jwtAudience = builder.Configuration["Jwt:Audience"] ?? throw new InvalidOperationException("JWT Audience not configured");

builder.Services.AddAuthentication(options =>
{
    options.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;
    options.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;
})
.AddJwtBearer(options =>
{
    options.TokenValidationParameters = new TokenValidationParameters
    {
        ValidateIssuer = true,
        ValidateAudience = true,
        ValidateLifetime = true,
        ValidateIssuerSigningKey = true,
        ValidIssuer = jwtIssuer,
        ValidAudience = jwtAudience,
        IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey))
    };
});

builder.Services.AddAuthorization();

// CORS
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowAll", policy =>
    {
        policy.AllowAnyOrigin()
              .AllowAnyMethod()
              .AllowAnyHeader();
    });
});

var app = builder.Build();

// Configure the HTTP request pipeline
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

app.UseHttpsRedirection();
app.UseCors("AllowAll");
app.UseAuthentication();
app.UseAuthorization();
app.MapControllers();

app.Run();
 
 
==================== WeatherForecast.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\ 
 
namespace OrganizationalMessenger.API
{
    public class WeatherForecast
    {
        public DateOnly Date { get; set; }

        public int TemperatureC { get; set; }

        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);

        public string? Summary { get; set; }
    }
}
 
 
==================== AuthController.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\Controllers\ 
 
﻿using Microsoft.AspNetCore.Mvc;

namespace OrganizationalMessenger.API.Controllers
{
    public class AuthController : Controller
    {
        public IActionResult Index()
        {
            return View();
        }
    }
}
 
 
==================== GroupsController.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\Controllers\ 
 
﻿using Microsoft.AspNetCore.Mvc;

namespace OrganizationalMessenger.API.Controllers
{
    public class GroupsController : Controller
    {
        public IActionResult Index()
        {
            return View();
        }
    }
}
 
 
==================== MessagesController.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\Controllers\ 
 
﻿using Microsoft.AspNetCore.Mvc;

namespace OrganizationalMessenger.API.Controllers
{
    public class MessagesController : Controller
    {
        public IActionResult Index()
        {
            return View();
        }
    }
}
 
 
==================== UsersController.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\Controllers\ 
 
﻿using Microsoft.AspNetCore.Mvc;

namespace OrganizationalMessenger.API.Controllers
{
    public class UsersController : Controller
    {
        public IActionResult Index()
        {
            return View();
        }
    }
}
 
 
==================== ErrorHandlingMiddleware.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\Middleware\ 
 
﻿namespace OrganizationalMessenger.API.Middleware
{
    public class ErrorHandlingMiddleware
    {
    }
}
 
 
==================== .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\obj\Debug\net8.0\ 
 
// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]
 
 
==================== OrganizationalMessenger.API.AssemblyInfo.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\obj\Debug\net8.0\ 
 
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("OrganizationalMessenger.API")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+0a6cf97d17a7529676d54880d5db7070f8dddde6")]
[assembly: System.Reflection.AssemblyProductAttribute("OrganizationalMessenger.API")]
[assembly: System.Reflection.AssemblyTitleAttribute("OrganizationalMessenger.API")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Generated by the MSBuild WriteCodeFragment class.

 
 
==================== OrganizationalMessenger.API.GlobalUsings.g.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\obj\Debug\net8.0\ 
 
// <auto-generated/>
global using global::Microsoft.AspNetCore.Builder;
global using global::Microsoft.AspNetCore.Hosting;
global using global::Microsoft.AspNetCore.Http;
global using global::Microsoft.AspNetCore.Routing;
global using global::Microsoft.Extensions.Configuration;
global using global::Microsoft.Extensions.DependencyInjection;
global using global::Microsoft.Extensions.Hosting;
global using global::Microsoft.Extensions.Logging;
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Net.Http.Json;
global using global::System.Threading;
global using global::System.Threading.Tasks;
 
 
==================== OrganizationalMessenger.API.MvcApplicationPartsAssemblyInfo.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.API\obj\Debug\net8.0\ 
 
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: Microsoft.AspNetCore.Mvc.ApplicationParts.ApplicationPartAttribute("Swashbuckle.AspNetCore.SwaggerGen")]

// Generated by the MSBuild WriteCodeFragment class.

 
 
==================== CreateChannelDto.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\DTOs\Channel\ 
 
﻿namespace OrganizationalMessenger.Application.DTOs.Channel
{
    public class CreateChannelDto
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public bool IsPublic { get; set; } = true;
        public bool OnlyAdminsCanPost { get; set; } = true;
        public bool AllowComments { get; set; } = false;
    }
} 
 
==================== CreateGroupDto.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\DTOs\Group\ 
 
﻿namespace OrganizationalMessenger.Application.DTOs.Group
{
    public class CreateGroupDto
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public bool IsPublic { get; set; }
        public int MaxMembers { get; set; } = 200;
    }
} 
 
==================== IAuthenticationManager.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\Interfaces\ 
 
﻿using OrganizationalMessenger.Domain.Enums;  // ✅ اضافه کنید
namespace OrganizationalMessenger.Application.Interfaces
{
    public interface IAuthenticationManager
    {
        Task<AuthenticationResult> AuthenticateAsync(string username, string password, AuthenticationType type);
        Task<(bool Success, string Message)> SendOtpAsync(string phoneNumber);
        IAuthenticationProvider GetProvider(AuthenticationType type);
    }


}
 
 
==================== IAuthenticationProvider.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\Interfaces\ 
 
﻿namespace OrganizationalMessenger.Application.Interfaces
{
    public interface IAuthenticationProvider
    {
        Task<AuthenticationResult> AuthenticateAsync(string username, string password);
    }

    public class AuthenticationResult
    {
        public bool IsSuccess { get; set; }
        public string? ErrorMessage { get; set; }
        public string? UserId { get; set; }
        public string? FirstName { get; set; }
        public string? LastName { get; set; }
        public string? Email { get; set; }
        public string? PhoneNumber { get; set; }
    }
}
 
 
==================== IChannelService.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\Interfaces\ 
 
﻿using System.Collections.Generic;
using System.Threading.Tasks;

// ✅ استفاده از alias
using DomainChannel = OrganizationalMessenger.Domain.Entities.Channel;
using DomainUser = OrganizationalMessenger.Domain.Entities.User;

namespace OrganizationalMessenger.Application.Interfaces
{
    public interface IChannelService
    {
        Task<DomainChannel> CreateChannelAsync(DomainChannel channel, int creatorId);
        Task<DomainChannel> GetChannelByIdAsync(int channelId);
        Task<List<DomainChannel>> GetUserChannelsAsync(int userId);
        Task<List<DomainChannel>> GetPublicChannelsAsync();
        Task SubscribeAsync(int channelId, int userId);
        Task UnsubscribeAsync(int channelId, int userId);
        Task<bool> IsSubscriberAsync(int channelId, int userId);
        Task<bool> IsAdminAsync(int channelId, int userId);
        Task UpdateChannelAsync(DomainChannel channel);
        Task DeleteChannelAsync(int channelId);
        Task<List<DomainUser>> GetSubscribersAsync(int channelId);
        Task AddAdminAsync(int channelId, int userId, int promoterId);
        Task RemoveAdminAsync(int channelId, int userId, int demoterId);
    }
} 
 
==================== IGroupService.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\Interfaces\ 
 
﻿using System.Collections.Generic;
using System.Threading.Tasks;

// ✅ استفاده از alias
using DomainGroup = OrganizationalMessenger.Domain.Entities.Group;
using DomainUser = OrganizationalMessenger.Domain.Entities.User;

namespace OrganizationalMessenger.Application.Interfaces
{
    public interface IGroupService
    {
        Task<DomainGroup> CreateGroupAsync(DomainGroup group, int creatorId);
        Task<DomainGroup> GetGroupByIdAsync(int groupId);
        Task<List<DomainGroup>> GetUserGroupsAsync(int userId);
        Task<List<DomainGroup>> GetPublicGroupsAsync();
        Task AddMemberAsync(int groupId, int userId);
        Task RemoveMemberAsync(int groupId, int userId);
        Task<bool> IsMemberAsync(int groupId, int userId);
        Task<bool> IsAdminAsync(int groupId, int userId);
        Task UpdateGroupAsync(DomainGroup group);
        Task DeleteGroupAsync(int groupId);
        Task<List<DomainUser>> GetGroupMembersAsync(int groupId);
        Task PromoteToAdminAsync(int groupId, int userId, int promoterId);
        Task DemoteFromAdminAsync(int groupId, int userId, int demoterId);
    }
} 
 
==================== ISmsService.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\Interfaces\ 
 
﻿namespace OrganizationalMessenger.Application.Interfaces
{
    public interface ISmsService
    {
        Task<SmsResult> SendOtpAsync(string phoneNumber, string otpCode);
        Task<SmsResult> SendMessageAsync(string phoneNumber, string message);
    }

    public class SmsResult
    {
        public bool Success { get; set; }
        public string Message { get; set; } = "";
        public string? MessageId { get; set; }
    }
}
 
 
==================== .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\obj\Debug\net8.0\ 
 
// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]
 
 
==================== OrganizationalMessenger.Application.AssemblyInfo.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\obj\Debug\net8.0\ 
 
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("OrganizationalMessenger.Application")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+0a6cf97d17a7529676d54880d5db7070f8dddde6")]
[assembly: System.Reflection.AssemblyProductAttribute("OrganizationalMessenger.Application")]
[assembly: System.Reflection.AssemblyTitleAttribute("OrganizationalMessenger.Application")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Generated by the MSBuild WriteCodeFragment class.

 
 
==================== OrganizationalMessenger.Application.GlobalUsings.g.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Application\obj\Debug\net8.0\ 
 
// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;
 
 
==================== AdminUser.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class AdminUser
    {
        public int Id { get; set; }
        public string Username { get; set; } = string.Empty;
        public string PasswordHash { get; set; } = string.Empty;
        public string FirstName { get; set; } = string.Empty;
        public string LastName { get; set; } = string.Empty;
        public string? Email { get; set; }
        public bool IsActive { get; set; } = true;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? LastLoginAt { get; set; }

        public string FullName => $"{FirstName} {LastName}";
    }
}
 
 
==================== BaseEntity.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public abstract class BaseEntity
    {
        public int Id { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? UpdatedAt { get; set; }
        public bool IsDeleted { get; set; } = false;
        public DateTime? DeletedAt { get; set; }
    }
}
 
 
==================== Call.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class Call : BaseEntity
    {
        public int InitiatorId { get; set; }
        public int? ReceiverId { get; set; }
        public CallType Type { get; set; }
        public CallDestinationType DestinationType { get; set; }

        // مقصد تماس
        public int? GroupId { get; set; }
        public int? ChannelId { get; set; }

        // وضعیت
        public CallStatus Status { get; set; } = CallStatus.Initiated;
        public DateTime StartedAt { get; set; } = DateTime.Now;
        public DateTime? EndedAt { get; set; }
        public int? Duration { get; set; }

        // لینک جلسه گروهی
        public string? MeetingLink { get; set; }
        public string? MeetingPassword { get; set; }

        // Navigation Properties
        public User Initiator { get; set; } = null!;
        public User? Receiver { get; set; }
        public Group? Group { get; set; }
        public Channel? Channel { get; set; }
        public ICollection<Message> Messages { get; set; } = new List<Message>();
    }
}
 
 
==================== Channel.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace OrganizationalMessenger.Domain.Entities
{
    /// <summary>
    /// Entity کانال - برای ارتباطات یک‌طرفه (اطلاع‌رسانی)
    /// </summary>
    public class Channel
    {
        public int Id { get; set; }

        [Required]
        [StringLength(200)]
        public string Name { get; set; } = string.Empty;

        [StringLength(1000)]
        public string? Description { get; set; }

        [StringLength(500)]
        public string? AvatarUrl { get; set; }

        public int CreatorId { get; set; }

        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? UpdatedAt { get; set; }

        public bool IsActive { get; set; } = true;
        public bool IsPublic { get; set; } = true;

        // ==================== حذف نرم ====================
        public bool IsDeleted { get; set; } = false;
        public DateTime? DeletedAt { get; set; }

        // ==================== تنظیمات کانال ====================

        /// <summary>
        /// آیا فقط ادمین‌ها می‌توانند پیام ارسال کنند
        /// </summary>
        public bool OnlyAdminsCanPost { get; set; } = true;

        /// <summary>
        /// آیا کامنت‌گذاری فعال است
        /// </summary>
        public bool AllowComments { get; set; } = false;

        /// <summary>
        /// آیا کانال خصوصی است (نیاز به لینک دعوت)
        /// </summary>
        public bool IsPrivate { get; set; } = false;

        /// <summary>
        /// لینک دعوت یکتا
        /// </summary>
        [StringLength(100)]
        public string? InviteLink { get; set; }

        // ==================== آمار ====================

        public int MemberCount { get; set; } = 0;

        // ==================== Navigation Properties ====================

        [ForeignKey(nameof(CreatorId))]
        public virtual User Creator { get; set; } = null!;

        public virtual ICollection<UserChannel> UserChannels { get; set; } = new List<UserChannel>();
        public virtual ICollection<Message> Messages { get; set; } = new List<Message>();
        public virtual ICollection<Call> Calls { get; set; } = new List<Call>();

        // ==================== متدهای کمکی ====================

        /// <summary>
        /// علامت‌گذاری به عنوان حذف شده
        /// </summary>
        public void MarkAsDeleted()
        {
            IsDeleted = true;
            DeletedAt = DateTime.Now;
            IsActive = false;
        }

        /// <summary>
        /// بازیابی کانال حذف شده
        /// </summary>
        public void Restore()
        {
            IsDeleted = false;
            DeletedAt = null;
            IsActive = true;
        }

        /// <summary>
        /// تولید لینک دعوت جدید
        /// </summary>
        public string GenerateInviteLink()
        {
            InviteLink = Guid.NewGuid().ToString("N")[..16];
            return InviteLink;
        }

        /// <summary>
        /// به‌روزرسانی تعداد اعضا
        /// </summary>
        public void UpdateMemberCount(int count)
        {
            MemberCount = count;
            UpdatedAt = DateTime.Now;
        }
    }
}
 
 
==================== FileAttachment.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace OrganizationalMessenger.Domain.Entities
{
    /// <summary>
    /// Entity برای مدیریت فایل‌های ضمیمه شده به پیام‌ها
    /// </summary>
    public class FileAttachment
    {
        public int Id { get; set; }

        // ==================== اطلاعات فایل ====================

        [Required]
        [StringLength(255)]
        public string FileName { get; set; } = string.Empty;

        [Required]
        [StringLength(255)]
        public string OriginalFileName { get; set; } = string.Empty;

        [Required]
        [StringLength(500)]
        public string FilePath { get; set; } = string.Empty;

        [StringLength(500)]
        public string? FileUrl { get; set; }

        [StringLength(100)]
        public string? ContentType { get; set; }

        [StringLength(10)]
        public string? Extension { get; set; }

        public long FileSize { get; set; }

        // ==================== نوع فایل ====================

        [StringLength(50)]
        public string FileType { get; set; } = "File";

        // ==================== Thumbnail ====================

        [StringLength(500)]
        public string? ThumbnailPath { get; set; }

        [StringLength(500)]
        public string? ThumbnailUrl { get; set; }

        public int? Width { get; set; }
        public int? Height { get; set; }

        // ==================== برای فایل‌های صوتی/ویدیویی ====================

        public int? Duration { get; set; }

        // ==================== آپلودکننده ====================

        public int UploaderId { get; set; }

        [ForeignKey(nameof(UploaderId))]
        public virtual User Uploader { get; set; } = null!;

        // ==================== پیام مرتبط ====================

        /// <summary>
        /// ⚠️ نوع باید با Message.Id یکسان باشد (int)
        /// </summary>
        public int? MessageId { get; set; }  // ✅ تغییر از long? به int?

        [ForeignKey(nameof(MessageId))]
        public virtual Message? Message { get; set; }

        // ==================== تاریخ‌ها ====================

        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? DeletedAt { get; set; }
        public bool IsDeleted { get; set; } = false;

        // ==================== Hash ====================

        [StringLength(64)]
        public string? FileHash { get; set; }

        // ==================== اسکن آنتی‌ویروس ====================

        public bool IsScanned { get; set; } = false;
        public bool IsSafe { get; set; } = true;
        public DateTime? ScannedAt { get; set; }

        [StringLength(500)]
        public string? ScanResult { get; set; }

        // ==================== آمار دانلود ====================

        public int DownloadCount { get; set; } = 0;
        public DateTime? LastDownloadAt { get; set; }

        // ==================== متدهای کمکی ====================

        [NotMapped]
        public string ReadableFileSize
        {
            get
            {
                string[] sizes = { "B", "KB", "MB", "GB", "TB" };
                double len = FileSize;
                int order = 0;
                while (len >= 1024 && order < sizes.Length - 1)
                {
                    order++;
                    len = len / 1024;
                }
                return $"{len:0.##} {sizes[order]}";
            }
        }

        [NotMapped]
        public string? ReadableDuration
        {
            get
            {
                if (!Duration.HasValue) return null;
                var ts = TimeSpan.FromSeconds(Duration.Value);
                if (ts.Hours > 0)
                    return $"{ts.Hours:D2}:{ts.Minutes:D2}:{ts.Seconds:D2}";
                return $"{ts.Minutes:D2}:{ts.Seconds:D2}";
            }
        }

        [NotMapped]
        public bool IsImage => FileType?.ToLower() == "image" ||
            new[] { ".jpg", ".jpeg", ".png", ".gif", ".bmp", ".webp", ".svg" }
            .Contains(Extension?.ToLower());

        [NotMapped]
        public bool IsVideo => FileType?.ToLower() == "video" ||
            new[] { ".mp4", ".avi", ".mkv", ".mov", ".wmv", ".webm" }
            .Contains(Extension?.ToLower());

        [NotMapped]
        public bool IsAudio => FileType?.ToLower() == "audio" ||
            new[] { ".mp3", ".wav", ".ogg", ".m4a", ".aac", ".flac" }
            .Contains(Extension?.ToLower());

        [NotMapped]
        public bool IsDocument => FileType?.ToLower() == "document" ||
            new[] { ".pdf", ".doc", ".docx", ".xls", ".xlsx", ".ppt", ".pptx", ".txt", ".rtf" }
            .Contains(Extension?.ToLower());

        public void IncrementDownloadCount()
        {
            DownloadCount++;
            LastDownloadAt = DateTime.Now;
        }

        public void MarkAsDeleted()
        {
            IsDeleted = true;
            DeletedAt = DateTime.Now;
        }

        public void SetScanResult(bool isSafe, string? result = null)
        {
            IsScanned = true;
            IsSafe = isSafe;
            ScannedAt = DateTime.Now;
            ScanResult = result;
        }
    }
}
 
 
==================== FileUploadSetting.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class FileUploadSetting
    {
        public int Id { get; set; }
        public string FileType { get; set; } = string.Empty; // مثل: jpg, png, pdf, mp4
        public string Category { get; set; } = string.Empty; // Image, Video, Audio, Document
        public long MaxSize { get; set; } // بایت
        public bool IsAllowed { get; set; } = true;
    }
}
 
 
==================== ForbiddenWord.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class ForbiddenWord
    {
        public int Id { get; set; }
        public string Word { get; set; } = string.Empty;
        public bool IsActive { get; set; } = true;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
    }
}
 
 
==================== Group.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class Group : BaseEntity
    {
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
        public string? AvatarUrl { get; set; }
        public int CreatorId { get; set; }
        public bool IsActive { get; set; } = true;
        public bool IsPublic { get; set; } = false;
        public int MaxMembers { get; set; } = 200;

        // Navigation Properties
        public User Creator { get; set; } = null!;
        public ICollection<UserGroup> UserGroups { get; set; } = new List<UserGroup>();
        public ICollection<GroupMember> Members { get; set; } = new List<GroupMember>();
        public ICollection<Message> Messages { get; set; } = new List<Message>();
        public ICollection<Call> Calls { get; set; } = new List<Call>();
    }
}
 
 
==================== GroupMember.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class GroupMember
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int GroupId { get; set; }
        public GroupRole Role { get; set; } = GroupRole.Member;
        public DateTime JoinedAt { get; set; } = DateTime.Now;
        public bool IsMuted { get; set; } = false;
        public DateTime? MutedUntil { get; set; }
        public bool IsActive { get; set; } = true;

        // Navigation Properties
        public User User { get; set; } = null!;
        public Group Group { get; set; } = null!;
    }
}
 
 
==================== LoginLog.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿
using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class LoginLog
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public AuthenticationType AuthType { get; set; }
        public string? IpAddress { get; set; }
        public string? UserAgent { get; set; }
        public bool IsSuccessful { get; set; }
        public string? FailureReason { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public User User { get; set; } = null!;
    }
}
 
 
==================== Message.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class Message : BaseEntity
    {
        // فرستنده و گیرنده
        public int SenderId { get; set; }
        public int? ReceiverId { get; set; } // برای پیام خصوصی
         
        // گروه یا کانال
        public int? GroupId { get; set; }
        public int? ChannelId { get; set; }

        // محتوای پیام
        public string? MessageText { get; set; } // ⭐ اضافه شد - نام قدیمی
        public string? Content { get; set; } // نام جدید (هر دو را نگه می‌داریم)
        public string? EncryptedContent { get; set; }

        // نوع پیام
        public MessageType Type { get; set; } = MessageType.Text;

        // فایل پیوست
        public string? AttachmentUrl { get; set; }
        public string? AttachmentName { get; set; }
        public string? AttachmentType { get; set; }
        public long? AttachmentSize { get; set; }


        // زمان‌ها
        public DateTime SentAt { get; set; } = DateTime.Now; // ⭐ اضافه شد
        public DateTime? DeliveredAt { get; set; }

        // وضعیت‌ها
        public bool IsDelivered { get; set; } = false;
        public bool IsEdited { get; set; } = false;
        public DateTime? EditedAt { get; set; }


        public bool IsDeleted { get; set; } = false;  // ✅ اضافه کنید
        public DateTime? DeletedAt { get; set; }      // ✅ اضافه کنید
        public int? DeletedByUserId { get; set; }     // ✅ اختیاری: چه کسی حذف کرده


        // Reply و Forward
        public int? ReplyToMessageId { get; set; }
        public int? ForwardedFromMessageId { get; set; }



        

        // ✅ Forward
        public int? ForwardedFromUserId { get; set; }  // فرستنده اصلی
        public Message? ForwardedFromMessage { get; set; }  // Navigation
        public User? ForwardedFromUser { get; set; }  // Navigation



        // تماس مرتبط
        public int? CallId { get; set; }

        // پیام سیستمی
        public bool IsSystemMessage { get; set; } = false;

        // Navigation Properties
        public User Sender { get; set; } = null!;
        public User? Receiver { get; set; }
        public Group? Group { get; set; }
        public Channel? Channel { get; set; }
        public Message? ReplyToMessage { get; set; }
        public Call? Call { get; set; }

        public ICollection<Message> Replies { get; set; } = new List<Message>();
        public ICollection<MessageReaction> Reactions { get; set; } = new List<MessageReaction>();
        public ICollection<MessageRead> ReadReceipts { get; set; } = new List<MessageRead>();

        public virtual ICollection<FileAttachment> Attachments { get; set; } = new List<FileAttachment>();

    }
}
 
 
==================== MessageReaction.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class MessageReaction
    {
        public int Id { get; set; }
        public int MessageId { get; set; }
        public int UserId { get; set; }
        public string Emoji { get; set; } = string.Empty;
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public Message Message { get; set; } = null!;
        public User User { get; set; } = null!;
    }
}
 
 
==================== MessageRead.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class MessageRead
    {
        public int Id { get; set; }
        public int MessageId { get; set; }
        public int UserId { get; set; }
        public DateTime ReadAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public Message Message { get; set; } = null!;
        public User User { get; set; } = null!;
    }
}
 
 
==================== MessageReport.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class MessageReport
    {
        public int Id { get; set; }
        public int MessageId { get; set; }
        public int ReporterId { get; set; }
        public string? Description { get; set; }
        public bool IsReviewed { get; set; } = false;
        public int? ReviewedByAdminId { get; set; }
        public DateTime? ReviewedAt { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public Message Message { get; set; } = null!;
        public User Reporter { get; set; } = null!;
        public User? ReviewedByAdmin { get; set; }
    }
}
 
 
==================== Poll.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class Poll
    {
        public int Id { get; set; }
        public string Question { get; set; } = string.Empty;
        public int CreatorId { get; set; }
        public int? GroupId { get; set; }
        public int? ChannelId { get; set; }
        public bool AllowMultipleAnswers { get; set; } = false;
        public bool IsAnonymous { get; set; } = false;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? ExpiresAt { get; set; }
        public bool IsActive { get; set; } = true;

        // Navigation Properties
        public User Creator { get; set; } = null!;
        public Group? Group { get; set; }
        public Channel? Channel { get; set; }
        public ICollection<PollOption> Options { get; set; } = new List<PollOption>();
    }
}
 
 
==================== PollOption.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class PollOption
    {
        public int Id { get; set; }
        public int PollId { get; set; }
        public string Text { get; set; } = string.Empty;
        public int DisplayOrder { get; set; } = 0;

        // Navigation Properties
        public Poll Poll { get; set; } = null!;
        public ICollection<PollVote> Votes { get; set; } = new List<PollVote>();
    }
}
 
 
==================== PollVote.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class PollVote
    {
        public int Id { get; set; }
        public int PollOptionId { get; set; }
        public int UserId { get; set; }
        public DateTime VotedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public PollOption PollOption { get; set; } = null!;
        public User User { get; set; } = null!;
    }
}
 
 
==================== Report.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿// Path: OrganizationalMessenger.Domain/Entities/Report.cs

using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class Report
    {
        public int Id { get; set; }

        // گزارش‌دهنده
        public int ReporterId { get; set; }

        // نوع آیتم گزارش شده
        public ReportItemType ItemType { get; set; }

        // شناسه آیتم گزارش شده
        public int? ReportedUserId { get; set; }
        public int? ReportedMessageId { get; set; }
        public int? ReportedGroupId { get; set; }
        public int? ReportedChannelId { get; set; }

        // جزئیات
        public string Reason { get; set; } = string.Empty;
        public string? Description { get; set; }

        // وضعیت
        public ReportStatus Status { get; set; } = ReportStatus.Pending;

        // پاسخ ادمین
        public long? ReviewedByAdminId { get; set; }
        public string? AdminNote { get; set; }
        public DateTime? ReviewedAt { get; set; }

        // زمان‌ها
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public User Reporter { get; set; } = null!;
        public User? ReportedUser { get; set; }
        public Message? ReportedMessage { get; set; }
        public Group? ReportedGroup { get; set; }
        public Channel? ReportedChannel { get; set; }
        public User? ReviewedByAdmin { get; set; }
    }
}
 
 
==================== ReportedMessage.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class ReportedMessage
    {
        public int Id { get; set; }
        public long MessageId { get; set; }
        public int ReporterId { get; set; } // کسی که گزارش داده
        public string? Reason { get; set; }
        public ReportStatus Status { get; set; } = ReportStatus.Pending;
        public DateTime ReportedAt { get; set; } = DateTime.Now;
        public DateTime? ReviewedAt { get; set; }
        public int? ReviewedByAdminId { get; set; }
        public string? AdminNote { get; set; }

        // Navigation
        public Message Message { get; set; } = null!;
        public User Reporter { get; set; } = null!;
        public AdminUser? ReviewedByAdmin { get; set; }
    }
}
 
 
==================== ServiceLink.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class ServiceLink
    {
        public int Id { get; set; }
        public string Title { get; set; } = string.Empty;
        public string? Description { get; set; }
        public string Url { get; set; } = string.Empty;
        public string IconUrl { get; set; } = string.Empty;
        public string? IconClass { get; set; } // برای Font Awesome
        public int DisplayOrder { get; set; } = 0;
        public bool IsActive { get; set; } = true;
        public bool OpenInNewTab { get; set; } = true;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public int CreatedByAdminId { get; set; }

        // Navigation
        public AdminUser CreatedByAdmin { get; set; } = null!;
    }
}
 
 
==================== SmsCreditLog.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class SmsCreditLog
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int Amount { get; set; } // مثبت: شارژ، منفی: مصرف
        public string Description { get; set; } = string.Empty;
        public int? RelatedMessageId { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public User User { get; set; } = null!;
        public Message? RelatedMessage { get; set; }
    }
}
 
 
==================== SmsCreditRequest.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class SmsCreditRequest
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int RequestedAmount { get; set; }
        public string? Reason { get; set; }
        public SmsCreditRequestStatus Status { get; set; } = SmsCreditRequestStatus.Pending;
        public DateTime RequestedAt { get; set; } = DateTime.Now;
        public DateTime? ProcessedAt { get; set; }
        public int? ProcessedByAdminId { get; set; }
        public int? ApprovedAmount { get; set; }
        public string? AdminNote { get; set; }

        // Navigation
        public User User { get; set; } = null!;
        public AdminUser? ProcessedByAdmin { get; set; }
    }
}
 
 
==================== StarredMessage.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class StarredMessage
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int MessageId { get; set; }
        public DateTime StarredAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public User User { get; set; } = null!;
        public Message Message { get; set; } = null!;
    }
}
 
 
==================== SystemAlert.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class SystemAlert
    {
        public int Id { get; set; }
        public string Title { get; set; } = string.Empty;
        public string Content { get; set; } = string.Empty;
        public AlertType Type { get; set; } = AlertType.Info;
        public AlertDeliveryType DeliveryType { get; set; } = AlertDeliveryType.Immediate;
        public bool IsActive { get; set; } = true;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? ExpiresAt { get; set; }
        public int CreatedByAdminId { get; set; }

        // Navigation
        public AdminUser CreatedByAdmin { get; set; } = null!;
        public ICollection<SystemAlertRead> ReadBy { get; set; } = new List<SystemAlertRead>();
    }

    public class SystemAlertRead
    {
        public int Id { get; set; }
        public int AlertId { get; set; }
        public int UserId { get; set; }
        public DateTime ReadAt { get; set; } = DateTime.Now;

        // Navigation
        public SystemAlert Alert { get; set; } = null!;
        public User User { get; set; } = null!;
    }
}
 
 
==================== SystemNotification.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class SystemNotification
    {
        public int Id { get; set; }
        public string Title { get; set; } = string.Empty;
        public string Content { get; set; } = string.Empty;
        public int SenderId { get; set; }
        public bool SendImmediately { get; set; } = true;
        public bool ShowOnLogin { get; set; } = false;
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? ExpiresAt { get; set; }
        public bool IsActive { get; set; } = true;

        // Navigation Properties
        public User Sender { get; set; } = null!;
    }
}
 
 
==================== SystemSetting.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class SystemSetting
    {
        public int Id { get; set; }
        public string Key { get; set; } = string.Empty;
        public string Value { get; set; } = string.Empty;
        public string? Description { get; set; }
        public string Category { get; set; } = "General";
        public DateTime UpdatedAt { get; set; } = DateTime.Now;
        public int? UpdatedByAdminId { get; set; }

        // Navigation
        public AdminUser? UpdatedByAdmin { get; set; }
    }

    /// <summary>
    /// کلیدهای استاندارد تنظیمات - برای استفاده در کد
    /// </summary>
    public static class SettingKeys
    {
        // احراز هویت
        public const string AuthType = "Auth.Type";
        public const string ADServer = "Auth.AD.Server";
        public const string ADDomain = "Auth.AD.Domain";
        public const string ERPApiUrl = "Auth.ERP.ApiUrl";
        public const string ERPApiKey = "Auth.ERP.ApiKey";
        public const string SMSProviderUrl = "Auth.SMS.ProviderUrl";
        public const string SMSApiKey = "Auth.SMS.ApiKey";
        public const string SMSSenderNumber = "Auth.SMS.SenderNumber";
        public const string OTPExpirationMinutes = "Auth.OTP.ExpirationMinutes";

        // VoIP
        public const string VoIPEnabled = "VoIP.Enabled";
        public const string VoIPServerUrl = "VoIP.ServerUrl";
        public const string VoIPUsername = "VoIP.Username";
        public const string VoIPPassword = "VoIP.Password";
        public const string VoIPProtocol = "VoIP.Protocol";

        // تلگرام
        public const string TelegramEnabled = "Telegram.Enabled";
        public const string TelegramBotToken = "Telegram.BotToken";

        // فایل
        public const string MaxImageSize = "File.MaxImageSize";
        public const string MaxVideoSize = "File.MaxVideoSize";
        public const string MaxFileSize = "File.MaxFileSize";
        public const string AllowedImageTypes = "File.AllowedImageTypes";
        public const string AllowedVideoTypes = "File.AllowedVideoTypes";
        public const string AllowedFileTypes = "File.AllowedFileTypes";

        // پیام
        public const string MessageEditEnabled = "Message.EditEnabled";
        public const string MessageDeleteEnabled = "Message.DeleteEnabled";
        public const string MessageEditTimeLimit = "Message.EditTimeLimit";
        public const string MessageDeleteTimeLimit = "Message.DeleteTimeLimit";
        public const string MessageDeleteAfterRead = "Message.DeleteAfterRead";
        public const string AdminCanDeleteMessages = "Message.AdminCanDelete";
        public const string EncryptionEnabled = "Message.EncryptionEnabled";
        public const string ShowDeletedMessageNotice = "Message.ShowDeletedMessageNotice ";

        // گروه و کانال
        public const string AllUsersCanCreateGroup = "Group.AllCanCreate";
        public const string AllUsersCanCreateChannel = "Channel.AllCanCreate";
        public const string MaxGroupMembers = "Group.MaxMembers";
        public const string MaxChannelMembers = "Channel.MaxMembers";

        // عمومی
        public const string CompanyName = "General.CompanyName";
        public const string CompanyLogo = "General.CompanyLogo";
        public const string DefaultSmsCredit = "General.DefaultSmsCredit";
    }
}
 
 
==================== TelegramMessage.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class TelegramMessage
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public string TelegramChatId { get; set; } = string.Empty;
        public string? TelegramUsername { get; set; }
        public string? Content { get; set; }
        public string? AttachmentUrl { get; set; }
        public bool IsIncoming { get; set; } // true = از تلگرام به سیستم
        public bool IsRead { get; set; } = false;
        public DateTime CreatedAt { get; set; } = DateTime.Now;

        // Navigation Properties
        public User User { get; set; } = null!;
    }
}
 
 
==================== User.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace OrganizationalMessenger.Domain.Entities
{
    public class User : BaseEntity
    {
        [Required]
        [StringLength(50)]
        public string Username { get; set; } = string.Empty;

        [Required]
        [StringLength(50)]
        public string FirstName { get; set; } = string.Empty;

        [Required]
        [StringLength(50)]
        public string LastName { get; set; } = string.Empty;

        [NotMapped]
        public string FullName => $"{FirstName} {LastName}";

        [StringLength(15)]
        public string? PhoneNumber { get; set; }

        [StringLength(100)]
        [EmailAddress]
        public string? Email { get; set; }

        [StringLength(256)]
        public string? PasswordHash { get; set; }

        // ==================== تصویر پروفایل ====================
        [StringLength(500)]
        public string? ProfilePicture { get; set; }

        [StringLength(500)]
        public string? AvatarUrl { get; set; } // اضافه شد برای سازگاری با ChatController

        [StringLength(200)]
        public string? Bio { get; set; }

        // ==================== وضعیت آنلاین ====================
        public bool IsOnline { get; set; } = false;
        public DateTime? LastSeen { get; set; }
        public DateTime? LastSeenAt { get; set; }

        // ==================== احراز هویت Active Directory ====================
        [StringLength(100)]
        public string? ActiveDirectoryId { get; set; }

        public bool IsADAuthenticated { get; set; } = false;

        // ==================== احراز هویت ERP ====================
        [StringLength(50)]
        public string? ErpUserId { get; set; }

        public bool IsErpAuthenticated { get; set; } = false;

        // ==================== احراز هویت OTP ====================
        [StringLength(10)]
        public string? OtpCode { get; set; }

        public DateTime? OtpExpireTime { get; set; }
        public bool IsOtpVerified { get; set; } = false;

        // ==================== مجوزها و دسترسی‌ها ====================
        public bool CanCreateGroup { get; set; } = true;
        public bool CanCreateChannel { get; set; } = true;
        public bool CanMakeVoiceCall { get; set; } = true;
        public bool CanMakeVideoCall { get; set; } = true;
        public bool IsAdmin { get; set; } = false;

        // ==================== اعتبار پیامک ====================
        public int SmsCredit { get; set; } = 10;

        // ==================== تنظیمات VoIP ====================
        [StringLength(50)]
        public string? VoipExtension { get; set; }

        [StringLength(100)]
        public string? VoipPassword { get; set; }

        public bool VoipEnabled { get; set; } = false;

        // ==================== تنظیمات اعلان‌ها ====================
        public bool NotificationsEnabled { get; set; } = true;
        public bool SoundEnabled { get; set; } = true;
        public bool ShowPreview { get; set; } = true;

        // ==================== وضعیت حساب ====================
        public bool IsActive { get; set; } = true;
        public bool IsBlocked { get; set; } = false;

        [StringLength(500)]
        public string? BlockReason { get; set; }

        public DateTime? BlockedAt { get; set; }

        // ==================== کلید عمومی E2E ====================
        [StringLength(1000)]
        public string? PublicKey { get; set; }

        // ==================== Refresh Token ====================
        [StringLength(500)]
        public string? RefreshToken { get; set; }

        public DateTime? RefreshTokenExpiry { get; set; }

        // ==================== Navigation Properties ====================

        // پیام‌های ارسالی
        public virtual ICollection<Message> SentMessages { get; set; } = new List<Message>();

        // پیام‌های دریافتی
        public virtual ICollection<Message> ReceivedMessages { get; set; } = new List<Message>();

        // گروه‌های ایجاد شده
        public virtual ICollection<Group> CreatedGroups { get; set; } = new List<Group>();

        // عضویت در گروه‌ها
        public virtual ICollection<UserGroup> UserGroups { get; set; } = new List<UserGroup>();

        // کانال‌های ایجاد شده
        public virtual ICollection<Channel> CreatedChannels { get; set; } = new List<Channel>();

        // عضویت در کانال‌ها
        public virtual ICollection<UserChannel> UserChannels { get; set; } = new List<UserChannel>();

        // تماس‌های شروع شده
        public virtual ICollection<Call> InitiatedCalls { get; set; } = new List<Call>();

        // تماس‌های دریافت شده
        public virtual ICollection<Call> ReceivedCalls { get; set; } = new List<Call>();

        // فایل‌های آپلود شده
        public virtual ICollection<FileAttachment> UploadedFiles { get; set; } = new List<FileAttachment>();

        // واکنش‌ها
        public virtual ICollection<MessageReaction> Reactions { get; set; } = new List<MessageReaction>();

        // پیام‌های ستاره‌دار
        public virtual ICollection<StarredMessage> StarredMessages { get; set; } = new List<StarredMessage>();

        // گزارش‌های پیام
        public virtual ICollection<MessageReport> MessageReports { get; set; } = new List<MessageReport>();

        // لاگ‌های ورود
        public virtual ICollection<LoginLog> LoginLogs { get; set; } = new List<LoginLog>();

        // لاگ‌های اعتبار پیامک
        public virtual ICollection<SmsCreditLog> SmsCreditLogs { get; set; } = new List<SmsCreditLog>();

        // ==================== متدهای کمکی ====================

        /// <summary>
        /// به‌روزرسانی زمان آخرین مشاهده
        /// </summary>
        public void UpdateLastSeen()
        {
            LastSeen = DateTime.Now;
            LastSeenAt = DateTime.Now;
        }

        /// <summary>
        /// تنظیم کاربر به حالت آنلاین
        /// </summary>
        public void SetOnline()
        {
            IsOnline = true;
            UpdateLastSeen();
        }

        /// <summary>
        /// تنظیم کاربر به حالت آفلاین
        /// </summary>
        public void SetOffline()
        {
            IsOnline = false;
            UpdateLastSeen();
        }

        /// <summary>
        /// تولید کد OTP جدید
        /// </summary>
        public string GenerateOtp(int expirationMinutes = 5)
        {
            var random = new Random();
            OtpCode = random.Next(100000, 999999).ToString();
            OtpExpireTime = DateTime.Now.AddMinutes(expirationMinutes);
            IsOtpVerified = false;
            return OtpCode;
        }

        /// <summary>
        /// اعتبارسنجی کد OTP
        /// </summary>
        public bool ValidateOtp(string code)
        {
            if (string.IsNullOrEmpty(OtpCode) || OtpExpireTime == null)
                return false;

            if (OtpExpireTime < DateTime.Now)
                return false;

            if (OtpCode != code)
                return false;

            IsOtpVerified = true;
            OtpCode = null;
            OtpExpireTime = null;
            return true;
        }

        /// <summary>
        /// کاهش اعتبار پیامک
        /// </summary>
        public bool DeductSmsCredit(int amount = 1)
        {
            if (SmsCredit < amount)
                return false;

            SmsCredit -= amount;
            return true;
        }

        /// <summary>
        /// افزایش اعتبار پیامک
        /// </summary>
        public void AddSmsCredit(int amount)
        {
            SmsCredit += amount;
        }
    }
}
 
 
==================== UserChannel.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    /// <summary>
    /// جدول واسط برای ارتباط Many-to-Many بین User و Channel
    /// </summary>
    public class UserChannel
    {
        public int Id { get; set; }

        public int UserId { get; set; }
        public int ChannelId { get; set; }

        // ==================== نقش و دسترسی‌ها ====================

        /// <summary>
        /// نقش کاربر در کانال
        /// </summary>
        public ChannelRole Role { get; set; } = ChannelRole.Subscriber;

        /// <summary>
        /// آیا کاربر ادمین کانال است
        /// </summary>
        public bool IsAdmin { get; set; } = false;

        /// <summary>
        /// آیا کاربر مالک/سازنده کانال است
        /// </summary>
        public bool IsOwner { get; set; } = false;

        /// <summary>
        /// آیا کاربر می‌تواند پیام ارسال کند
        /// </summary>
        public bool CanPost { get; set; } = false;

        /// <summary>
        /// آیا کاربر می‌تواند پیام حذف کند
        /// </summary>
        public bool CanDeleteMessages { get; set; } = false;

        /// <summary>
        /// آیا کاربر می‌تواند اعضا را مدیریت کند
        /// </summary>
        public bool CanManageMembers { get; set; } = false;

        // ==================== وضعیت عضویت ====================

        /// <summary>
        /// آیا عضویت فعال است
        /// </summary>
        public bool IsActive { get; set; } = true;

        /// <summary>
        /// تاریخ عضویت
        /// </summary>
        public DateTime JoinedAt { get; set; } = DateTime.Now;

        /// <summary>
        /// تاریخ لغو عضویت
        /// </summary>
        public DateTime? LeftAt { get; set; }

        // ==================== تنظیمات اعلان ====================

        /// <summary>
        /// آیا اعلان‌های کانال برای کاربر فعال است
        /// </summary>
        public bool NotificationsEnabled { get; set; } = true;

        /// <summary>
        /// آیا کانال برای کاربر بی‌صدا شده
        /// </summary>
        public bool IsMuted { get; set; } = false;

        /// <summary>
        /// تاریخ پایان بی‌صدا بودن
        /// </summary>
        public DateTime? MutedUntil { get; set; }

        /// <summary>
        /// آیا کانال پین شده است
        /// </summary>
        public bool IsPinned { get; set; } = false;

        // ==================== وضعیت خواندن پیام‌ها ====================

        /// <summary>
        /// آخرین پیام خوانده شده
        /// </summary>
        public long? LastReadMessageId { get; set; }

        /// <summary>
        /// تعداد پیام‌های خوانده نشده
        /// </summary>
        public int UnreadCount { get; set; } = 0;

        // ==================== Navigation Properties ====================

        [ForeignKey(nameof(UserId))]
        public virtual User User { get; set; } = null!;

        [ForeignKey(nameof(ChannelId))]
        public virtual Channel Channel { get; set; } = null!;

        // ==================== متدهای کمکی ====================

        /// <summary>
        /// ترک کانال
        /// </summary>
        public void Leave()
        {
            IsActive = false;
            LeftAt = DateTime.Now;
        }

        /// <summary>
        /// پیوستن مجدد به کانال
        /// </summary>
        public void Rejoin()
        {
            IsActive = true;
            LeftAt = null;
            JoinedAt = DateTime.Now;
        }

        /// <summary>
        /// بی‌صدا کردن کانال
        /// </summary>
        public void Mute(DateTime? until = null)
        {
            IsMuted = true;
            MutedUntil = until;
            NotificationsEnabled = false;
        }

        /// <summary>
        /// فعال کردن صدای کانال
        /// </summary>
        public void Unmute()
        {
            IsMuted = false;
            MutedUntil = null;
            NotificationsEnabled = true;
        }

        /// <summary>
        /// علامت‌گذاری همه پیام‌ها به عنوان خوانده شده
        /// </summary>
        public void MarkAllAsRead(long lastMessageId)
        {
            LastReadMessageId = lastMessageId;
            UnreadCount = 0;
        }

        /// <summary>
        /// افزایش تعداد پیام‌های خوانده نشده
        /// </summary>
        public void IncrementUnread()
        {
            UnreadCount++;
        }

        /// <summary>
        /// ارتقا به ادمین
        /// </summary>
        public void PromoteToAdmin()
        {
            IsAdmin = true;
            CanPost = true;
            CanDeleteMessages = true;
            CanManageMembers = true;
            Role = ChannelRole.Admin;
        }

        /// <summary>
        /// تنزل از ادمین
        /// </summary>
        public void DemoteFromAdmin()
        {
            IsAdmin = false;
            CanDeleteMessages = false;
            CanManageMembers = false;
            Role = CanPost ? ChannelRole.Publisher : ChannelRole.Subscriber;
        }

        /// <summary>
        /// تنظیم به عنوان مالک
        /// </summary>
        public void SetAsOwner()
        {
            IsOwner = true;
            IsAdmin = true;
            CanPost = true;
            CanDeleteMessages = true;
            CanManageMembers = true;
            Role = ChannelRole.Owner;
        }
    }
}
 
 
==================== UserGroup.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Domain.Entities
{
    public class UserGroup
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int GroupId { get; set; }

        // نقش کاربر در گروه
        public GroupRole Role { get; set; } = GroupRole.Member;
        public bool IsAdmin { get; set; } = false; // ⭐ اضافه شد

        // تنظیمات
        public bool IsMuted { get; set; } = false;
        public DateTime? MutedUntil { get; set; }

        // زمان‌ها
        public DateTime JoinedAt { get; set; } = DateTime.Now;
        public bool IsActive { get; set; } = true;

        // Navigation Properties
        public User User { get; set; } = null!;
        public Group Group { get; set; } = null!;
    }
}
 
 
==================== UserPermission.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Entities\ 
 
﻿namespace OrganizationalMessenger.Domain.Entities
{
    public class UserPermission
    {
        public int Id { get; set; }
        public int UserId { get; set; }

        // مجوزهای گروه و کانال
        public bool CanCreateGroup { get; set; } = false;
        public bool CanCreateChannel { get; set; } = false;
        public bool CanCreatePoll { get; set; } = false;

        // مجوزهای ارتباطی
        public bool CanSendBroadcast { get; set; } = false; // آلرت به همه
        public bool CanUseTelegram { get; set; } = false;
        public bool CanUseVoIP { get; set; } = false;

        // اعتبار پیامک
        public int SmsCredit { get; set; } = 0;
        public int SmsCreditUsedThisYear { get; set; } = 0;
        public int SmsCreditYear { get; set; } = DateTime.Now.Year;

        // شماره داخلی VoIP
        public string? VoIPExtension { get; set; }

        // تاریخ‌ها
        public DateTime CreatedAt { get; set; } = DateTime.Now;
        public DateTime? UpdatedAt { get; set; }

        // Navigation
        public User User { get; set; } = null!;
    }
}
 
 
==================== Enums.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\Enums\ 
 
﻿namespace OrganizationalMessenger.Domain.Enums
{
    public enum GroupRole
    {
        Member = 0,
        Admin = 1,
        Owner = 2
    }

  
    public enum ChannelRole
    {
        Subscriber = 0,  // فقط خواندن
        Publisher = 1,   // ارسال پست
        Admin = 2,       // مدیریت
        Owner = 3        // مالک
    }


    public enum AuthenticationType
    {
        Database = 0,      // شماره موبایل از دیتابیس
        ActiveDirectory = 1,
        ERP = 2,
        SMS = 3           // اضافه شد - OTP پیامکی
    }
    public enum MessageType
    {
        Text = 0,
        Image = 1,
        Video = 2,
        Audio = 3,
        Voice = 4,
        File = 5,
        Location = 6,
        Contact = 7,
        Poll = 8,
        System = 9
    }

  
    public enum CallType
    {
        Voice = 0,
        Video = 1
    }

    public enum CallDestinationType
    {
        Private = 0,
        Group = 1,
        Channel = 2
    }

    public enum CallStatus
    {
        Initiated = 0,
        Ringing = 1,
        InProgress = 2,
        Ended = 3,
        Missed = 4,
        Rejected = 5,
        Failed = 6
    }


    public enum ReportStatus
    {
        Pending = 0,
        Reviewed = 1,
        Resolved = 2,
        Dismissed = 3,
        ActionTaken = 4
    }
    

    public enum MessageDestinationType
    {
        Direct = 1,
        Group = 2,
        Channel = 3
    }


   
    // === Enum های جدید ===

    public enum AlertType
    {
        Info = 0,
        Warning = 1,
        Error = 2,
        Success = 3
    }

    public enum AlertDeliveryType
    {
        Immediate = 0,      // فقط کاربران آنلاین
        Persistent = 1      // همه کاربران (ذخیره در پیام‌های سیستم)
    }

    public enum SmsCreditRequestStatus
    {
        Pending = 0,
        Approved = 1,
        Rejected = 2,
        PartiallyApproved = 3
    }

    public enum SettingCategory
    {
        Authentication = 0,
        VoIP = 1,
        Telegram = 2,
        FileUpload = 3,
        Message = 4,
        GroupChannel = 5,
        General = 6
    }
    public enum ReportItemType
    {
        User = 1,
        Message = 2,
        Group = 3,
        Channel = 4
    }






}
 
 
==================== .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\obj\Debug\net8.0\ 
 
// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]
 
 
==================== OrganizationalMessenger.Domain.AssemblyInfo.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\obj\Debug\net8.0\ 
 
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("OrganizationalMessenger.Domain")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+0a6cf97d17a7529676d54880d5db7070f8dddde6")]
[assembly: System.Reflection.AssemblyProductAttribute("OrganizationalMessenger.Domain")]
[assembly: System.Reflection.AssemblyTitleAttribute("OrganizationalMessenger.Domain")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Generated by the MSBuild WriteCodeFragment class.

 
 
==================== OrganizationalMessenger.Domain.GlobalUsings.g.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Domain\obj\Debug\net8.0\ 
 
// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;
 
 
==================== ActiveDirectoryProvider.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Authentication\ 
 
﻿using Microsoft.Extensions.Configuration;
using OrganizationalMessenger.Application.Interfaces;
using OrganizationalMessenger.Domain.Entities;
using System.DirectoryServices.AccountManagement;

namespace OrganizationalMessenger.Infrastructure.Authentication
{
    public class ActiveDirectoryProvider : IAuthenticationProvider
    {
        private readonly IConfiguration _configuration;

        public ActiveDirectoryProvider(IConfiguration configuration)
        {
            _configuration = configuration;
        }

        public async Task<AuthenticationResult> AuthenticateAsync(string username, string password)
        {
            return await Task.Run(() =>
            {
                try
                {
                    var domain = _configuration["Authentication:ActiveDirectory:Domain"];

                    using var context = new PrincipalContext(ContextType.Domain, domain);

                    bool isValid = context.ValidateCredentials(username, password);

                    if (!isValid)
                    {
                        return new AuthenticationResult
                        {
                            IsSuccess = false,
                            ErrorMessage = "نام کاربری یا رمز عبور اشتباه است."
                        };
                    }

                    using var userPrincipal = UserPrincipal.FindByIdentity(context, username);

                    if (userPrincipal == null)
                    {
                        return new AuthenticationResult
                        {
                            IsSuccess = false,
                            ErrorMessage = "کاربر یافت نشد."
                        };
                    }

                    return new AuthenticationResult
                    {
                        IsSuccess = true,
                        UserId = userPrincipal.SamAccountName,
                        FirstName = userPrincipal.GivenName,
                        LastName = userPrincipal.Surname,
                        Email = userPrincipal.EmailAddress,
                        PhoneNumber = userPrincipal.VoiceTelephoneNumber
                    };
                }
                catch (Exception ex)
                {
                    return new AuthenticationResult
                    {
                        IsSuccess = false,
                        ErrorMessage = $"خطا در احراز هویت: {ex.Message}"
                    };
                }
            });
        }
    }
}
 
 
==================== AuthenticationManager.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Authentication\ 
 
﻿using Microsoft.Extensions.DependencyInjection;
using OrganizationalMessenger.Application.Interfaces;
using OrganizationalMessenger.Domain.Enums;

namespace OrganizationalMessenger.Infrastructure.Authentication
{
    public class AuthenticationManager : IAuthenticationManager
    {
        private readonly IServiceProvider _serviceProvider;

        public AuthenticationManager(IServiceProvider serviceProvider)
        {
            _serviceProvider = serviceProvider;
        }

        public async Task<AuthenticationResult> AuthenticateAsync(
            string username,
            string password,
            AuthenticationType type)
        {
            var provider = GetProvider(type);
            return await provider.AuthenticateAsync(username, password);
        }

        public async Task<(bool Success, string Message)> SendOtpAsync(string phoneNumber)
        {
            var otpProvider = _serviceProvider.GetRequiredService<OtpAuthenticationProvider>();
            return await otpProvider.SendOtpAsync(phoneNumber);
        }

        public IAuthenticationProvider GetProvider(AuthenticationType type)
        {
            return type switch
            {
                AuthenticationType.ActiveDirectory =>
                    _serviceProvider.GetRequiredService<ActiveDirectoryProvider>(),

                AuthenticationType.ERP =>
                    _serviceProvider.GetRequiredService<ErpAuthenticationProvider>(),

                AuthenticationType.SMS =>
                    _serviceProvider.GetRequiredService<OtpAuthenticationProvider>(),

                _ => throw new NotSupportedException($"Authentication type {type} is not supported.")
            };
        }
    }
}
 
 
==================== CustomUserIdProvider.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Authentication\ 
 
﻿using Microsoft.AspNetCore.SignalR;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Claims;
using System.Text;
using System.Threading.Tasks;


namespace OrganizationalMessenger.Infrastructure.Authentication
{
    namespace OrganizationalMessenger.Infrastructure.Authentication
    {
        public class CustomUserIdProvider : IUserIdProvider
        {
            public string? GetUserId(HubConnectionContext connection)
            {
                return connection.User?
                    .FindFirst(ClaimTypes.NameIdentifier)?
                    .Value;
            }
        }
    }


}
 
 
==================== ErpAuthenticationProvider.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Authentication\ 
 
﻿using Microsoft.Extensions.Configuration;
using OrganizationalMessenger.Application.Interfaces;
using System.Net.Http.Json;

namespace OrganizationalMessenger.Infrastructure.Authentication
{
    public class ErpAuthenticationProvider : IAuthenticationProvider
    {
        private readonly HttpClient _httpClient;
        private readonly IConfiguration _configuration;

        public ErpAuthenticationProvider(
            IConfiguration configuration,
            IHttpClientFactory httpClientFactory)
        {
            _configuration = configuration;
            _httpClient = httpClientFactory.CreateClient();
        }

        public async Task<AuthenticationResult> AuthenticateAsync(string username, string password)
        {
            try
            {
                var apiUrl = _configuration["Authentication:ERP:ApiUrl"];
                var apiKey = _configuration["Authentication:ERP:ApiKey"];

                var request = new
                {
                    username = username,
                    password = password
                };

                _httpClient.DefaultRequestHeaders.Add("X-API-Key", apiKey);

                var response = await _httpClient.PostAsJsonAsync(
                    $"{apiUrl}/api/auth/validate",
                    request);

                if (!response.IsSuccessStatusCode)
                {
                    return new AuthenticationResult
                    {
                        IsSuccess = false,
                        ErrorMessage = "نام کاربری یا رمز عبور اشتباه است."
                    };
                }

                var result = await response.Content.ReadFromJsonAsync<ErpAuthResponse>();

                return new AuthenticationResult
                {
                    IsSuccess = true,
                    UserId = result?.UserId,
                    FirstName = result?.FirstName,
                    LastName = result?.LastName,
                    Email = result?.Email,
                    PhoneNumber = result?.PhoneNumber
                };
            }
            catch (Exception ex)
            {
                return new AuthenticationResult
                {
                    IsSuccess = false,
                    ErrorMessage = $"خطا در اتصال به سیستم ERP: {ex.Message}"
                };
            }
        }

        private class ErpAuthResponse
        {
            public string? UserId { get; set; }
            public string? FirstName { get; set; }
            public string? LastName { get; set; }
            public string? Email { get; set; }
            public string? PhoneNumber { get; set; }
        }
    }
}
 
 
==================== OtpAuthenticationProvider.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Authentication\ 
 
﻿using Microsoft.EntityFrameworkCore;
using OrganizationalMessenger.Application.Interfaces;
using OrganizationalMessenger.Infrastructure.Data;

namespace OrganizationalMessenger.Infrastructure.Authentication
{
    public class OtpAuthenticationProvider : IAuthenticationProvider
    {
        private readonly ApplicationDbContext _context;
        private readonly ISmsService _smsService;
        private static readonly Dictionary<string, (string Code, DateTime Expiry)> _otpCache = new();

        public OtpAuthenticationProvider(
            ApplicationDbContext context,
            ISmsService smsService)
        {
            _context = context;
            _smsService = smsService;
        }

        public async Task<AuthenticationResult> AuthenticateAsync(string phoneNumber, string otpCode)
        {
            if (!_otpCache.TryGetValue(phoneNumber, out var cachedOtp))
            {
                return new AuthenticationResult
                {
                    IsSuccess = false,
                    ErrorMessage = "کد تایید یافت نشد. لطفاً دوباره درخواست دهید."
                };
            }

            if (cachedOtp.Expiry < DateTime.UtcNow)
            {
                _otpCache.Remove(phoneNumber);
                return new AuthenticationResult
                {
                    IsSuccess = false,
                    ErrorMessage = "کد تایید منقضی شده است."
                };
            }

            if (cachedOtp.Code != otpCode)
            {
                return new AuthenticationResult
                {
                    IsSuccess = false,
                    ErrorMessage = "کد تایید اشتباه است."
                };
            }

            _otpCache.Remove(phoneNumber);

            var user = await _context.Users
                .FirstOrDefaultAsync(u => u.PhoneNumber == phoneNumber);

            if (user == null)
            {
                return new AuthenticationResult
                {
                    IsSuccess = false,
                    ErrorMessage = "کاربر با این شماره تلفن یافت نشد."
                };
            }

            return new AuthenticationResult
            {
                IsSuccess = true,
                UserId = user.Id.ToString(),
                FirstName = user.FirstName,
                LastName = user.LastName,
                Email = user.Email,
                PhoneNumber = user.PhoneNumber
            };
        }

        public async Task<(bool Success, string Message)> SendOtpAsync(string phoneNumber)
        {
            var user = await _context.Users
                .FirstOrDefaultAsync(u => u.PhoneNumber == phoneNumber);

            if (user == null)
            {
                return (false, "کاربر با این شماره تلفن یافت نشد.");
            }

            var otpCode = new Random().Next(100000, 999999).ToString();
            var expiry = DateTime.UtcNow.AddMinutes(5);

            _otpCache[phoneNumber] = (otpCode, expiry);

            var smsResult = await _smsService.SendOtpAsync(phoneNumber, otpCode);

            return (smsResult.Success, smsResult.Message);
        }
    }
}
 
 
==================== ApplicationDbContext.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Data\ 
 
﻿using Microsoft.EntityFrameworkCore;
using OrganizationalMessenger.Domain.Entities;

namespace OrganizationalMessenger.Infrastructure.Data
{
    public class ApplicationDbContext : DbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        // ==================== DbSets ====================
        public DbSet<User> Users { get; set; }
        public DbSet<AdminUser> AdminUsers { get; set; }
        public DbSet<UserPermission> UserPermissions { get; set; }

        public DbSet<Message> Messages { get; set; }
        public DbSet<Group> Groups { get; set; }
        public DbSet<Channel> Channels { get; set; }
        public DbSet<UserGroup> UserGroups { get; set; }
        public DbSet<UserChannel> UserChannels { get; set; }
        public DbSet<GroupMember> GroupMembers { get; set; }
        public DbSet<Call> Calls { get; set; }
        public DbSet<MessageReaction> MessageReactions { get; set; }
        public DbSet<MessageRead> MessageReads { get; set; }
        public DbSet<StarredMessage> StarredMessages { get; set; }
        public DbSet<MessageReport> MessageReports { get; set; }
        public DbSet<ForbiddenWord> ForbiddenWords { get; set; }
        public DbSet<FileUploadSetting> FileUploadSettings { get; set; }
        public DbSet<SystemSetting> SystemSettings { get; set; }
        public DbSet<SystemNotification> SystemNotifications { get; set; }
        public DbSet<ServiceLink> ServiceLinks { get; set; }
        public DbSet<SmsCreditLog> SmsCreditLogs { get; set; }
        public DbSet<Poll> Polls { get; set; }
        public DbSet<PollOption> PollOptions { get; set; }
        public DbSet<PollVote> PollVotes { get; set; }
        public DbSet<LoginLog> LoginLogs { get; set; }
        public DbSet<TelegramMessage> TelegramMessages { get; set; }
        public DbSet<FileAttachment> FileAttachments { get; set; }

        public DbSet<Report> Reports { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);

            // ==================== User Configuration ====================
            modelBuilder.Entity<User>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Username)
                    .IsRequired()
                    .HasMaxLength(100);
                entity.HasIndex(e => e.Username).IsUnique();

                entity.Property(e => e.PhoneNumber)
                    .HasMaxLength(20);
                entity.HasIndex(e => e.PhoneNumber).IsUnique();

                entity.Property(e => e.Email).HasMaxLength(200);
                entity.Property(e => e.FirstName).HasMaxLength(100);
                entity.Property(e => e.LastName).HasMaxLength(100);
                entity.Property(e => e.PasswordHash).HasMaxLength(500);
                entity.Property(e => e.AvatarUrl).HasMaxLength(500);
                entity.Property(e => e.ActiveDirectoryId).HasMaxLength(200);
                entity.Property(e => e.ErpUserId).HasMaxLength(200);
                entity.Property(e => e.OtpCode).HasMaxLength(10);
                entity.Property(e => e.VoipExtension).HasMaxLength(50);
            });




            // ✅ MessageReaction Configuration
            modelBuilder.Entity<MessageReaction>(entity =>
            {
                entity.HasKey(mr => mr.Id);

                entity.HasOne(mr => mr.Message)
                    .WithMany(m => m.Reactions)
                    .HasForeignKey(mr => mr.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(mr => mr.User)
                    .WithMany()
                    .HasForeignKey(mr => mr.UserId)
                    .OnDelete(DeleteBehavior.Restrict);

                // ✅ فقط index معمولی برای performance
                entity.HasIndex(mr => new { mr.MessageId, mr.UserId });

                entity.Property(mr => mr.Emoji).HasMaxLength(10);
            });




            // ==================== AdminUser Configuration ====================
            modelBuilder.Entity<AdminUser>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Username)
                    .IsRequired()
                    .HasMaxLength(100);
                entity.HasIndex(e => e.Username).IsUnique();

                entity.Property(e => e.Email).HasMaxLength(200);
                entity.Property(e => e.FirstName).HasMaxLength(100);
                entity.Property(e => e.LastName).HasMaxLength(100);
                entity.Property(e => e.PasswordHash).HasMaxLength(500);

                // Seed Admin User
                entity.HasData(new AdminUser
                {
                    Id = 1,
                    Username = "admin",
                    PasswordHash = BCrypt.Net.BCrypt.HashPassword("Admin@123"),
                    FirstName = "مدیر",
                    LastName = "سیستم",
                    Email = "admin@company.com",
                    IsActive = true,
                    CreatedAt = DateTime.Now
                });
            });

            // ==================== Message Configuration ====================
            modelBuilder.Entity<Message>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Content).HasMaxLength(4000);
                entity.Property(e => e.EncryptedContent).HasMaxLength(8000);
                entity.Property(e => e.AttachmentUrl).HasMaxLength(500);
                entity.Property(e => e.AttachmentName).HasMaxLength(255);
                entity.Property(e => e.AttachmentType).HasMaxLength(100);

                // Sender Relationship
                entity.HasOne(e => e.Sender)
                    .WithMany(u => u.SentMessages)
                    .HasForeignKey(e => e.SenderId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Receiver Relationship (Private Chat)
                entity.HasOne(e => e.Receiver)
                    .WithMany(u => u.ReceivedMessages)
                    .HasForeignKey(e => e.ReceiverId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Group Relationship
                entity.HasOne(e => e.Group)
                    .WithMany(g => g.Messages)
                    .HasForeignKey(e => e.GroupId)
                    .OnDelete(DeleteBehavior.Cascade);

                // Channel Relationship
                entity.HasOne(e => e.Channel)
                    .WithMany(c => c.Messages)
                    .HasForeignKey(e => e.ChannelId)
                    .OnDelete(DeleteBehavior.Cascade);

                // Reply Relationship
                entity.HasOne(e => e.ReplyToMessage)
                    .WithMany(m => m.Replies)
                    .HasForeignKey(e => e.ReplyToMessageId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Forward Relationship
                entity.HasOne(e => e.ForwardedFromMessage)
                    .WithMany()
                    .HasForeignKey(e => e.ForwardedFromMessageId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Call Relationship
                entity.HasOne(e => e.Call)
                    .WithMany(c => c.Messages)
                    .HasForeignKey(e => e.CallId)
                    .OnDelete(DeleteBehavior.SetNull);

                // Indexes
                entity.HasIndex(e => e.SenderId);
                entity.HasIndex(e => e.ReceiverId);
                entity.HasIndex(e => e.GroupId);
                entity.HasIndex(e => e.ChannelId);
                entity.HasIndex(e => e.CreatedAt);
            });

            // ==================== Group Configuration ====================
            modelBuilder.Entity<Group>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Name)
                    .IsRequired()
                    .HasMaxLength(100);

                entity.Property(e => e.Description).HasMaxLength(500);
                entity.Property(e => e.AvatarUrl).HasMaxLength(500);

                // Creator Relationship
                entity.HasOne(e => e.Creator)
                    .WithMany(u => u.CreatedGroups)
                    .HasForeignKey(e => e.CreatorId)
                    .OnDelete(DeleteBehavior.Restrict);

                entity.HasIndex(e => e.CreatorId);
            });

            // ==================== Channel Configuration ====================
            modelBuilder.Entity<Channel>(entity =>
            {
                entity.HasKey(e => e.Id);

                entity.Property(e => e.Name)
                    .IsRequired()
                    .HasMaxLength(200);

                entity.Property(e => e.AvatarUrl)
                    .HasMaxLength(500);

                entity.HasOne(e => e.Creator)
                    .WithMany(u => u.CreatedChannels)
                    .HasForeignKey(e => e.CreatorId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Query Filter for Soft Delete
                entity.HasQueryFilter(e => !e.IsDeleted);
            });

            // FileAttachment Configuration
            modelBuilder.Entity<FileAttachment>(entity =>
            {
                entity.HasKey(e => e.Id);

                entity.HasIndex(e => e.FileHash);
                entity.HasIndex(e => e.UploaderId);
                entity.HasIndex(e => e.MessageId);
                entity.HasIndex(e => e.CreatedAt);

                entity.HasOne(e => e.Uploader)
                    .WithMany(u => u.UploadedFiles)
                    .HasForeignKey(e => e.UploaderId)
                    .OnDelete(DeleteBehavior.Restrict);

                entity.HasOne(e => e.Message)
                    .WithMany(m => m.Attachments)
                    .HasForeignKey(e => e.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);

                // Query Filter for Soft Delete
                entity.HasQueryFilter(e => !e.IsDeleted);
            });


            // ==================== UserGroup Configuration ====================
            modelBuilder.Entity<UserGroup>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                // Unique Index for User-Group combination
                entity.HasIndex(e => new { e.UserId, e.GroupId }).IsUnique();

                // User Relationship
                entity.HasOne(e => e.User)
                    .WithMany(u => u.UserGroups)
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                // Group Relationship
                entity.HasOne(e => e.Group)
                    .WithMany(g => g.UserGroups)
                    .HasForeignKey(e => e.GroupId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== UserChannel Configuration ====================
            // UserChannel Configuration
            modelBuilder.Entity<UserChannel>(entity =>
            {
                entity.HasKey(e => e.Id);

                entity.HasIndex(e => new { e.UserId, e.ChannelId }).IsUnique();

                entity.Property(e => e.Role)
                    .HasConversion<int>();

                entity.HasOne(e => e.User)
                    .WithMany(u => u.UserChannels)
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.Channel)
                    .WithMany(c => c.UserChannels)
                    .HasForeignKey(e => e.ChannelId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== GroupMember Configuration ====================
            modelBuilder.Entity<GroupMember>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.HasIndex(e => new { e.UserId, e.GroupId }).IsUnique();

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.Group)
                    .WithMany(g => g.Members)
                    .HasForeignKey(e => e.GroupId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== Call Configuration ====================
            modelBuilder.Entity<Call>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.MeetingLink).HasMaxLength(500);
                entity.Property(e => e.MeetingPassword).HasMaxLength(100);

                // Initiator Relationship
                entity.HasOne(e => e.Initiator)
                    .WithMany(u => u.InitiatedCalls)
                    .HasForeignKey(e => e.InitiatorId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Receiver Relationship
                entity.HasOne(e => e.Receiver)
                    .WithMany(u => u.ReceivedCalls)
                    .HasForeignKey(e => e.ReceiverId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Group Relationship
                entity.HasOne(e => e.Group)
                    .WithMany(g => g.Calls)
                    .HasForeignKey(e => e.GroupId)
                    .OnDelete(DeleteBehavior.Restrict);

                // Channel Relationship
                entity.HasOne(e => e.Channel)
                    .WithMany(c => c.Calls)
                    .HasForeignKey(e => e.ChannelId)
                    .OnDelete(DeleteBehavior.Restrict);

                entity.HasIndex(e => e.InitiatorId);
                entity.HasIndex(e => e.ReceiverId);
                entity.HasIndex(e => e.StartedAt);
            });

            // ==================== MessageReaction Configuration ====================
            modelBuilder.Entity<MessageReaction>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Emoji)
                    .IsRequired()
                    .HasMaxLength(50);

                entity.HasIndex(e => new { e.MessageId, e.UserId, e.Emoji }).IsUnique();

                entity.HasOne(e => e.Message)
                    .WithMany(m => m.Reactions)
                    .HasForeignKey(e => e.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== MessageRead Configuration ====================
            modelBuilder.Entity<MessageRead>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.HasIndex(e => new { e.MessageId, e.UserId }).IsUnique();

                entity.HasOne(e => e.Message)
                    .WithMany(m => m.ReadReceipts)
                    .HasForeignKey(e => e.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== StarredMessage Configuration ====================
            modelBuilder.Entity<StarredMessage>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.HasIndex(e => new { e.UserId, e.MessageId }).IsUnique();

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.Message)
                    .WithMany()
                    .HasForeignKey(e => e.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== MessageReport Configuration ====================
            modelBuilder.Entity<MessageReport>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Description).HasMaxLength(1000);

                entity.HasOne(e => e.Message)
                    .WithMany()
                    .HasForeignKey(e => e.MessageId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.Reporter)
                    .WithMany()
                    .HasForeignKey(e => e.ReporterId)
                    .OnDelete(DeleteBehavior.Restrict);

                entity.HasOne(e => e.ReviewedByAdmin)
                    .WithMany()
                    .HasForeignKey(e => e.ReviewedByAdminId)
                    .OnDelete(DeleteBehavior.Restrict);
            });

            // ==================== ForbiddenWord Configuration ====================
            modelBuilder.Entity<ForbiddenWord>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Word)
                    .IsRequired()
                    .HasMaxLength(100);

                entity.HasIndex(e => e.Word).IsUnique();
            });

            // ==================== FileUploadSetting Configuration ====================
            modelBuilder.Entity<FileUploadSetting>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.FileType)
                    .IsRequired()
                    .HasMaxLength(50);

                entity.Property(e => e.Category)
                    .IsRequired()
                    .HasMaxLength(50);

                entity.HasIndex(e => e.FileType).IsUnique();

                // Seed Default Settings
                entity.HasData(
                    new FileUploadSetting { Id = 1, FileType = "jpg", Category = "Image", MaxSize = 10 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 2, FileType = "jpeg", Category = "Image", MaxSize = 10 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 3, FileType = "png", Category = "Image", MaxSize = 10 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 4, FileType = "gif", Category = "Image", MaxSize = 5 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 5, FileType = "mp4", Category = "Video", MaxSize = 100 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 6, FileType = "webm", Category = "Video", MaxSize = 100 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 7, FileType = "mp3", Category = "Audio", MaxSize = 20 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 8, FileType = "wav", Category = "Audio", MaxSize = 20 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 9, FileType = "ogg", Category = "Audio", MaxSize = 20 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 10, FileType = "pdf", Category = "Document", MaxSize = 50 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 11, FileType = "doc", Category = "Document", MaxSize = 50 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 12, FileType = "docx", Category = "Document", MaxSize = 50 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 13, FileType = "xls", Category = "Document", MaxSize = 50 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 14, FileType = "xlsx", Category = "Document", MaxSize = 50 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 15, FileType = "zip", Category = "Archive", MaxSize = 100 * 1024 * 1024, IsAllowed = true },
                    new FileUploadSetting { Id = 16, FileType = "rar", Category = "Archive", MaxSize = 100 * 1024 * 1024, IsAllowed = true }
                );
            });

            // ==================== SystemSetting Configuration ====================
            modelBuilder.Entity<SystemSetting>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Key)
                    .IsRequired()
                    .HasMaxLength(100);

                entity.Property(e => e.Value)
                    .IsRequired()
                    .HasMaxLength(1000);

                entity.Property(e => e.Description).HasMaxLength(500);

                entity.HasIndex(e => e.Key).IsUnique();

                // Seed Default Settings
                entity.HasData(
                    new SystemSetting { Id = 1, Key = "AuthenticationType", Value = "Database", Description = "نوع احراز هویت: Database, ActiveDirectory, ERP" },
                    new SystemSetting { Id = 2, Key = "AllowUserGroupCreation", Value = "true", Description = "آیا کاربران می‌توانند گروه ایجاد کنند" },
                    new SystemSetting { Id = 3, Key = "AllowUserChannelCreation", Value = "true", Description = "آیا کاربران می‌توانند کانال ایجاد کنند" },
                    new SystemSetting { Id = 4, Key = "MessageEditTimeLimit", Value = "3600", Description = "زمان مجاز ویرایش پیام (ثانیه)" },
                    new SystemSetting { Id = 5, Key = "MessageDeleteTimeLimit", Value = "7200", Description = "زمان مجاز حذف پیام (ثانیه)" },
                    new SystemSetting { Id = 6, Key = "VoipEnabled", Value = "true", Description = "فعال بودن تماس VoIP" },
                    new SystemSetting { Id = 7, Key = "TelegramIntegrationEnabled", Value = "false", Description = "فعال بودن یکپارچگی تلگرام" },
                    new SystemSetting { Id = 8, Key = "MaxGroupMembers", Value = "200", Description = "حداکثر تعداد اعضای گروه" },
                    new SystemSetting { Id = 9, Key = "OtpExpiryMinutes", Value = "5", Description = "زمان انقضای کد OTP (دقیقه)" },
                    new SystemSetting { Id = 10, Key = "CompanyName", Value = "سازمان", Description = "نام سازمان" },
                    new SystemSetting { Id = 11, Key = "CompanyLogoUrl", Value = "/images/logo.png", Description = "آدرس لوگوی سازمان" }
                );
            });

            // ==================== SystemNotification Configuration ====================
            modelBuilder.Entity<SystemNotification>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Title)
                    .IsRequired()
                    .HasMaxLength(200);

                entity.Property(e => e.Content)
                    .IsRequired()
                    .HasMaxLength(2000);

                entity.HasOne(e => e.Sender)
                    .WithMany()
                    .HasForeignKey(e => e.SenderId)
                    .OnDelete(DeleteBehavior.Restrict);
            });

            // ==================== ServiceLink Configuration ====================
            modelBuilder.Entity<ServiceLink>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Title)
                    .IsRequired()
                    .HasMaxLength(100);

                entity.Property(e => e.Url)
                    .IsRequired()
                    .HasMaxLength(500);

                entity.Property(e => e.IconUrl).HasMaxLength(500);
            });

            // ==================== SmsCreditLog Configuration ====================
            modelBuilder.Entity<SmsCreditLog>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Description)
                    .IsRequired()
                    .HasMaxLength(500);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.RelatedMessage)
                    .WithMany()
                    .HasForeignKey(e => e.RelatedMessageId)
                    .OnDelete(DeleteBehavior.SetNull);

                entity.HasIndex(e => e.UserId);
                entity.HasIndex(e => e.CreatedAt);
            });

            // ==================== Poll Configuration ====================
            modelBuilder.Entity<Poll>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Question)
                    .IsRequired()
                    .HasMaxLength(500);

                entity.HasOne(e => e.Creator)
                    .WithMany()
                    .HasForeignKey(e => e.CreatorId)
                    .OnDelete(DeleteBehavior.Restrict);

                entity.HasOne(e => e.Group)
                    .WithMany()
                    .HasForeignKey(e => e.GroupId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.Channel)
                    .WithMany()
                    .HasForeignKey(e => e.ChannelId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== PollOption Configuration ====================
            modelBuilder.Entity<PollOption>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.Text)
                    .IsRequired()
                    .HasMaxLength(200);

                entity.HasOne(e => e.Poll)
                    .WithMany(p => p.Options)
                    .HasForeignKey(e => e.PollId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== PollVote Configuration ====================
            modelBuilder.Entity<PollVote>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.HasIndex(e => new { e.PollOptionId, e.UserId }).IsUnique();

                entity.HasOne(e => e.PollOption)
                    .WithMany(o => o.Votes)
                    .HasForeignKey(e => e.PollOptionId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);
            });

            // ==================== LoginLog Configuration ====================
            modelBuilder.Entity<LoginLog>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.IpAddress).HasMaxLength(50);
                entity.Property(e => e.UserAgent).HasMaxLength(500);
                entity.Property(e => e.FailureReason).HasMaxLength(500);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasIndex(e => e.UserId);
                entity.HasIndex(e => e.CreatedAt);
            });

            // ==================== TelegramMessage Configuration ====================
            modelBuilder.Entity<TelegramMessage>(entity =>
            {
                entity.HasKey(e => e.Id);
                entity.Property(e => e.Id).ValueGeneratedOnAdd();

                entity.Property(e => e.TelegramChatId)
                    .IsRequired()
                    .HasMaxLength(100);

                entity.Property(e => e.TelegramUsername).HasMaxLength(100);
                entity.Property(e => e.Content).HasMaxLength(4000);
                entity.Property(e => e.AttachmentUrl).HasMaxLength(500);

                entity.HasOne(e => e.User)
                    .WithMany()
                    .HasForeignKey(e => e.UserId)
                    .OnDelete(DeleteBehavior.Cascade);

                entity.HasIndex(e => e.UserId);
                entity.HasIndex(e => e.TelegramChatId);
            });
        }
    }
}
 
 
==================== 20260209061809_initDB.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

#pragma warning disable CA1814 // Prefer jagged arrays over multidimensional

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    /// <inheritdoc />
    public partial class initDB : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.CreateTable(
                name: "AdminUsers",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Username = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    PasswordHash = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    FirstName = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    LastName = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    Email = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: true),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    LastLoginAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_AdminUsers", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "FileUploadSettings",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    FileType = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: false),
                    Category = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: false),
                    MaxSize = table.Column<long>(type: "bigint", nullable: false),
                    IsAllowed = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_FileUploadSettings", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "ForbiddenWords",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Word = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_ForbiddenWords", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Users",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Username = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    FirstName = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    LastName = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    PhoneNumber = table.Column<string>(type: "nvarchar(20)", maxLength: 20, nullable: true),
                    Email = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: true),
                    PasswordHash = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    ProfilePicture = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    AvatarUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    Bio = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: true),
                    IsOnline = table.Column<bool>(type: "bit", nullable: false),
                    LastSeen = table.Column<DateTime>(type: "datetime2", nullable: true),
                    LastSeenAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    ActiveDirectoryId = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: true),
                    IsADAuthenticated = table.Column<bool>(type: "bit", nullable: false),
                    ErpUserId = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: true),
                    IsErpAuthenticated = table.Column<bool>(type: "bit", nullable: false),
                    OtpCode = table.Column<string>(type: "nvarchar(10)", maxLength: 10, nullable: true),
                    OtpExpireTime = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsOtpVerified = table.Column<bool>(type: "bit", nullable: false),
                    CanCreateGroup = table.Column<bool>(type: "bit", nullable: false),
                    CanCreateChannel = table.Column<bool>(type: "bit", nullable: false),
                    CanMakeVoiceCall = table.Column<bool>(type: "bit", nullable: false),
                    CanMakeVideoCall = table.Column<bool>(type: "bit", nullable: false),
                    IsAdmin = table.Column<bool>(type: "bit", nullable: false),
                    SmsCredit = table.Column<int>(type: "int", nullable: false),
                    VoipExtension = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: true),
                    VoipPassword = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    VoipEnabled = table.Column<bool>(type: "bit", nullable: false),
                    NotificationsEnabled = table.Column<bool>(type: "bit", nullable: false),
                    SoundEnabled = table.Column<bool>(type: "bit", nullable: false),
                    ShowPreview = table.Column<bool>(type: "bit", nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    IsBlocked = table.Column<bool>(type: "bit", nullable: false),
                    BlockReason = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    BlockedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    PublicKey = table.Column<string>(type: "nvarchar(1000)", maxLength: 1000, nullable: true),
                    RefreshToken = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    RefreshTokenExpiry = table.Column<DateTime>(type: "datetime2", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Users", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "ServiceLinks",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Title = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    Description = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    Url = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    IconUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    IconClass = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    DisplayOrder = table.Column<int>(type: "int", nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    OpenInNewTab = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    CreatedByAdminId = table.Column<int>(type: "int", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_ServiceLinks", x => x.Id);
                    table.ForeignKey(
                        name: "FK_ServiceLinks_AdminUsers_CreatedByAdminId",
                        column: x => x.CreatedByAdminId,
                        principalTable: "AdminUsers",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "SystemSettings",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Key = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    Value = table.Column<string>(type: "nvarchar(1000)", maxLength: 1000, nullable: false),
                    Description = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    Category = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedByAdminId = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_SystemSettings", x => x.Id);
                    table.ForeignKey(
                        name: "FK_SystemSettings_AdminUsers_UpdatedByAdminId",
                        column: x => x.UpdatedByAdminId,
                        principalTable: "AdminUsers",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "Channels",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: false),
                    Description = table.Column<string>(type: "nvarchar(1000)", maxLength: 1000, nullable: true),
                    AvatarUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    CreatorId = table.Column<int>(type: "int", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    IsPublic = table.Column<bool>(type: "bit", nullable: false),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    OnlyAdminsCanPost = table.Column<bool>(type: "bit", nullable: false),
                    AllowComments = table.Column<bool>(type: "bit", nullable: false),
                    IsPrivate = table.Column<bool>(type: "bit", nullable: false),
                    InviteLink = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    MemberCount = table.Column<int>(type: "int", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Channels", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Channels_Users_CreatorId",
                        column: x => x.CreatorId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "Groups",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    Description = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    AvatarUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    CreatorId = table.Column<int>(type: "int", nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    IsPublic = table.Column<bool>(type: "bit", nullable: false),
                    MaxMembers = table.Column<int>(type: "int", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Groups", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Groups_Users_CreatorId",
                        column: x => x.CreatorId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "LoginLogs",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    AuthType = table.Column<int>(type: "int", nullable: false),
                    IpAddress = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: true),
                    UserAgent = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    IsSuccessful = table.Column<bool>(type: "bit", nullable: false),
                    FailureReason = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UserId1 = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_LoginLogs", x => x.Id);
                    table.ForeignKey(
                        name: "FK_LoginLogs_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_LoginLogs_Users_UserId1",
                        column: x => x.UserId1,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "SystemNotifications",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Title = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: false),
                    Content = table.Column<string>(type: "nvarchar(2000)", maxLength: 2000, nullable: false),
                    SenderId = table.Column<int>(type: "int", nullable: false),
                    SendImmediately = table.Column<bool>(type: "bit", nullable: false),
                    ShowOnLogin = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    ExpiresAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsActive = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_SystemNotifications", x => x.Id);
                    table.ForeignKey(
                        name: "FK_SystemNotifications_Users_SenderId",
                        column: x => x.SenderId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "TelegramMessages",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    TelegramChatId = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: false),
                    TelegramUsername = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    Content = table.Column<string>(type: "nvarchar(4000)", maxLength: 4000, nullable: true),
                    AttachmentUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    IsIncoming = table.Column<bool>(type: "bit", nullable: false),
                    IsRead = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_TelegramMessages", x => x.Id);
                    table.ForeignKey(
                        name: "FK_TelegramMessages_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "UserPermissions",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    CanCreateGroup = table.Column<bool>(type: "bit", nullable: false),
                    CanCreateChannel = table.Column<bool>(type: "bit", nullable: false),
                    CanCreatePoll = table.Column<bool>(type: "bit", nullable: false),
                    CanSendBroadcast = table.Column<bool>(type: "bit", nullable: false),
                    CanUseTelegram = table.Column<bool>(type: "bit", nullable: false),
                    CanUseVoIP = table.Column<bool>(type: "bit", nullable: false),
                    SmsCredit = table.Column<int>(type: "int", nullable: false),
                    SmsCreditUsedThisYear = table.Column<int>(type: "int", nullable: false),
                    SmsCreditYear = table.Column<int>(type: "int", nullable: false),
                    VoIPExtension = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_UserPermissions", x => x.Id);
                    table.ForeignKey(
                        name: "FK_UserPermissions_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "UserChannels",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    ChannelId = table.Column<int>(type: "int", nullable: false),
                    Role = table.Column<int>(type: "int", nullable: false),
                    IsAdmin = table.Column<bool>(type: "bit", nullable: false),
                    IsOwner = table.Column<bool>(type: "bit", nullable: false),
                    CanPost = table.Column<bool>(type: "bit", nullable: false),
                    CanDeleteMessages = table.Column<bool>(type: "bit", nullable: false),
                    CanManageMembers = table.Column<bool>(type: "bit", nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false),
                    JoinedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    LeftAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    NotificationsEnabled = table.Column<bool>(type: "bit", nullable: false),
                    IsMuted = table.Column<bool>(type: "bit", nullable: false),
                    MutedUntil = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsPinned = table.Column<bool>(type: "bit", nullable: false),
                    LastReadMessageId = table.Column<long>(type: "bigint", nullable: true),
                    UnreadCount = table.Column<int>(type: "int", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_UserChannels", x => x.Id);
                    table.ForeignKey(
                        name: "FK_UserChannels_Channels_ChannelId",
                        column: x => x.ChannelId,
                        principalTable: "Channels",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_UserChannels_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "Calls",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    InitiatorId = table.Column<int>(type: "int", nullable: false),
                    ReceiverId = table.Column<int>(type: "int", nullable: true),
                    Type = table.Column<int>(type: "int", nullable: false),
                    DestinationType = table.Column<int>(type: "int", nullable: false),
                    GroupId = table.Column<int>(type: "int", nullable: true),
                    ChannelId = table.Column<int>(type: "int", nullable: true),
                    Status = table.Column<int>(type: "int", nullable: false),
                    StartedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    EndedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    Duration = table.Column<int>(type: "int", nullable: true),
                    MeetingLink = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    MeetingPassword = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Calls", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Calls_Channels_ChannelId",
                        column: x => x.ChannelId,
                        principalTable: "Channels",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Calls_Groups_GroupId",
                        column: x => x.GroupId,
                        principalTable: "Groups",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Calls_Users_InitiatorId",
                        column: x => x.InitiatorId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Calls_Users_ReceiverId",
                        column: x => x.ReceiverId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "GroupMembers",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    GroupId = table.Column<int>(type: "int", nullable: false),
                    Role = table.Column<int>(type: "int", nullable: false),
                    JoinedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    IsMuted = table.Column<bool>(type: "bit", nullable: false),
                    MutedUntil = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsActive = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_GroupMembers", x => x.Id);
                    table.ForeignKey(
                        name: "FK_GroupMembers_Groups_GroupId",
                        column: x => x.GroupId,
                        principalTable: "Groups",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_GroupMembers_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "Polls",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Question = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    CreatorId = table.Column<int>(type: "int", nullable: false),
                    GroupId = table.Column<int>(type: "int", nullable: true),
                    ChannelId = table.Column<int>(type: "int", nullable: true),
                    AllowMultipleAnswers = table.Column<bool>(type: "bit", nullable: false),
                    IsAnonymous = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    ExpiresAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsActive = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Polls", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Polls_Channels_ChannelId",
                        column: x => x.ChannelId,
                        principalTable: "Channels",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Polls_Groups_GroupId",
                        column: x => x.GroupId,
                        principalTable: "Groups",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Polls_Users_CreatorId",
                        column: x => x.CreatorId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "UserGroups",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    GroupId = table.Column<int>(type: "int", nullable: false),
                    Role = table.Column<int>(type: "int", nullable: false),
                    IsAdmin = table.Column<bool>(type: "bit", nullable: false),
                    IsMuted = table.Column<bool>(type: "bit", nullable: false),
                    MutedUntil = table.Column<DateTime>(type: "datetime2", nullable: true),
                    JoinedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    IsActive = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_UserGroups", x => x.Id);
                    table.ForeignKey(
                        name: "FK_UserGroups_Groups_GroupId",
                        column: x => x.GroupId,
                        principalTable: "Groups",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_UserGroups_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "Messages",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    SenderId = table.Column<int>(type: "int", nullable: false),
                    ReceiverId = table.Column<int>(type: "int", nullable: true),
                    GroupId = table.Column<int>(type: "int", nullable: true),
                    ChannelId = table.Column<int>(type: "int", nullable: true),
                    MessageText = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    Content = table.Column<string>(type: "nvarchar(4000)", maxLength: 4000, nullable: true),
                    EncryptedContent = table.Column<string>(type: "nvarchar(max)", maxLength: 8000, nullable: true),
                    Type = table.Column<int>(type: "int", nullable: false),
                    AttachmentUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    AttachmentName = table.Column<string>(type: "nvarchar(255)", maxLength: 255, nullable: true),
                    AttachmentType = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    AttachmentSize = table.Column<long>(type: "bigint", nullable: true),
                    SentAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    DeliveredAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    ReadAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsRead = table.Column<bool>(type: "bit", nullable: false),
                    IsDelivered = table.Column<bool>(type: "bit", nullable: false),
                    IsEdited = table.Column<bool>(type: "bit", nullable: false),
                    EditedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    ReplyToMessageId = table.Column<int>(type: "int", nullable: true),
                    ForwardedFromMessageId = table.Column<int>(type: "int", nullable: true),
                    CallId = table.Column<int>(type: "int", nullable: true),
                    IsSystemMessage = table.Column<bool>(type: "bit", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdatedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Messages", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Messages_Calls_CallId",
                        column: x => x.CallId,
                        principalTable: "Calls",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.SetNull);
                    table.ForeignKey(
                        name: "FK_Messages_Channels_ChannelId",
                        column: x => x.ChannelId,
                        principalTable: "Channels",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Messages_Groups_GroupId",
                        column: x => x.GroupId,
                        principalTable: "Groups",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Messages_Messages_ForwardedFromMessageId",
                        column: x => x.ForwardedFromMessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Messages_Messages_ReplyToMessageId",
                        column: x => x.ReplyToMessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Messages_Users_ReceiverId",
                        column: x => x.ReceiverId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_Messages_Users_SenderId",
                        column: x => x.SenderId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "PollOptions",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    PollId = table.Column<int>(type: "int", nullable: false),
                    Text = table.Column<string>(type: "nvarchar(200)", maxLength: 200, nullable: false),
                    DisplayOrder = table.Column<int>(type: "int", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_PollOptions", x => x.Id);
                    table.ForeignKey(
                        name: "FK_PollOptions_Polls_PollId",
                        column: x => x.PollId,
                        principalTable: "Polls",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "FileAttachments",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    FileName = table.Column<string>(type: "nvarchar(255)", maxLength: 255, nullable: false),
                    OriginalFileName = table.Column<string>(type: "nvarchar(255)", maxLength: 255, nullable: false),
                    FilePath = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    FileUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    ContentType = table.Column<string>(type: "nvarchar(100)", maxLength: 100, nullable: true),
                    Extension = table.Column<string>(type: "nvarchar(10)", maxLength: 10, nullable: true),
                    FileSize = table.Column<long>(type: "bigint", nullable: false),
                    FileType = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: false),
                    ThumbnailPath = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    ThumbnailUrl = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    Width = table.Column<int>(type: "int", nullable: true),
                    Height = table.Column<int>(type: "int", nullable: true),
                    Duration = table.Column<int>(type: "int", nullable: true),
                    UploaderId = table.Column<int>(type: "int", nullable: false),
                    MessageId = table.Column<int>(type: "int", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    DeletedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false),
                    FileHash = table.Column<string>(type: "nvarchar(64)", maxLength: 64, nullable: true),
                    IsScanned = table.Column<bool>(type: "bit", nullable: false),
                    IsSafe = table.Column<bool>(type: "bit", nullable: false),
                    ScannedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    ScanResult = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: true),
                    DownloadCount = table.Column<int>(type: "int", nullable: false),
                    LastDownloadAt = table.Column<DateTime>(type: "datetime2", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_FileAttachments", x => x.Id);
                    table.ForeignKey(
                        name: "FK_FileAttachments_Messages_MessageId",
                        column: x => x.MessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_FileAttachments_Users_UploaderId",
                        column: x => x.UploaderId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                });

            migrationBuilder.CreateTable(
                name: "MessageReactions",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    MessageId = table.Column<int>(type: "int", nullable: false),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    Emoji = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UserId1 = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_MessageReactions", x => x.Id);
                    table.ForeignKey(
                        name: "FK_MessageReactions_Messages_MessageId",
                        column: x => x.MessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_MessageReactions_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_MessageReactions_Users_UserId1",
                        column: x => x.UserId1,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "MessageReads",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    MessageId = table.Column<int>(type: "int", nullable: false),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    ReadAt = table.Column<DateTime>(type: "datetime2", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_MessageReads", x => x.Id);
                    table.ForeignKey(
                        name: "FK_MessageReads_Messages_MessageId",
                        column: x => x.MessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_MessageReads_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "MessageReports",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    MessageId = table.Column<int>(type: "int", nullable: false),
                    ReporterId = table.Column<int>(type: "int", nullable: false),
                    Description = table.Column<string>(type: "nvarchar(1000)", maxLength: 1000, nullable: true),
                    IsReviewed = table.Column<bool>(type: "bit", nullable: false),
                    ReviewedByAdminId = table.Column<int>(type: "int", nullable: true),
                    ReviewedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UserId = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_MessageReports", x => x.Id);
                    table.ForeignKey(
                        name: "FK_MessageReports_Messages_MessageId",
                        column: x => x.MessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_MessageReports_Users_ReporterId",
                        column: x => x.ReporterId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_MessageReports_Users_ReviewedByAdminId",
                        column: x => x.ReviewedByAdminId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Restrict);
                    table.ForeignKey(
                        name: "FK_MessageReports_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "Reports",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    ReporterId = table.Column<int>(type: "int", nullable: false),
                    ItemType = table.Column<int>(type: "int", nullable: false),
                    ReportedUserId = table.Column<int>(type: "int", nullable: true),
                    ReportedMessageId = table.Column<int>(type: "int", nullable: true),
                    ReportedGroupId = table.Column<int>(type: "int", nullable: true),
                    ReportedChannelId = table.Column<int>(type: "int", nullable: true),
                    Reason = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Description = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    Status = table.Column<int>(type: "int", nullable: false),
                    ReviewedByAdminId = table.Column<long>(type: "bigint", nullable: true),
                    AdminNote = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    ReviewedAt = table.Column<DateTime>(type: "datetime2", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    ReviewedByAdminId1 = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Reports", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Reports_Channels_ReportedChannelId",
                        column: x => x.ReportedChannelId,
                        principalTable: "Channels",
                        principalColumn: "Id");
                    table.ForeignKey(
                        name: "FK_Reports_Groups_ReportedGroupId",
                        column: x => x.ReportedGroupId,
                        principalTable: "Groups",
                        principalColumn: "Id");
                    table.ForeignKey(
                        name: "FK_Reports_Messages_ReportedMessageId",
                        column: x => x.ReportedMessageId,
                        principalTable: "Messages",
                        principalColumn: "Id");
                    table.ForeignKey(
                        name: "FK_Reports_Users_ReportedUserId",
                        column: x => x.ReportedUserId,
                        principalTable: "Users",
                        principalColumn: "Id");
                    table.ForeignKey(
                        name: "FK_Reports_Users_ReporterId",
                        column: x => x.ReporterId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Reports_Users_ReviewedByAdminId1",
                        column: x => x.ReviewedByAdminId1,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "SmsCreditLogs",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    Amount = table.Column<int>(type: "int", nullable: false),
                    Description = table.Column<string>(type: "nvarchar(500)", maxLength: 500, nullable: false),
                    RelatedMessageId = table.Column<int>(type: "int", nullable: true),
                    CreatedAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UserId1 = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_SmsCreditLogs", x => x.Id);
                    table.ForeignKey(
                        name: "FK_SmsCreditLogs_Messages_RelatedMessageId",
                        column: x => x.RelatedMessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.SetNull);
                    table.ForeignKey(
                        name: "FK_SmsCreditLogs_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_SmsCreditLogs_Users_UserId1",
                        column: x => x.UserId1,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "StarredMessages",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    MessageId = table.Column<int>(type: "int", nullable: false),
                    StarredAt = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UserId1 = table.Column<int>(type: "int", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_StarredMessages", x => x.Id);
                    table.ForeignKey(
                        name: "FK_StarredMessages_Messages_MessageId",
                        column: x => x.MessageId,
                        principalTable: "Messages",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_StarredMessages_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_StarredMessages_Users_UserId1",
                        column: x => x.UserId1,
                        principalTable: "Users",
                        principalColumn: "Id");
                });

            migrationBuilder.CreateTable(
                name: "PollVotes",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    PollOptionId = table.Column<int>(type: "int", nullable: false),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    VotedAt = table.Column<DateTime>(type: "datetime2", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_PollVotes", x => x.Id);
                    table.ForeignKey(
                        name: "FK_PollVotes_PollOptions_PollOptionId",
                        column: x => x.PollOptionId,
                        principalTable: "PollOptions",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_PollVotes_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.InsertData(
                table: "AdminUsers",
                columns: new[] { "Id", "CreatedAt", "Email", "FirstName", "IsActive", "LastLoginAt", "LastName", "PasswordHash", "Username" },
                values: new object[] { 1, new DateTime(2026, 2, 9, 9, 48, 8, 65, DateTimeKind.Local).AddTicks(9793), "admin@company.com", "مدیر", true, null, "سیستم", "$2a$11$9t1CsubdkLWzCxr5Nf2TvOGRMtSnqC.7Y2/jbkJXRIXFOrAw8nQby", "admin" });

            migrationBuilder.InsertData(
                table: "FileUploadSettings",
                columns: new[] { "Id", "Category", "FileType", "IsAllowed", "MaxSize" },
                values: new object[,]
                {
                    { 1, "Image", "jpg", true, 10485760L },
                    { 2, "Image", "jpeg", true, 10485760L },
                    { 3, "Image", "png", true, 10485760L },
                    { 4, "Image", "gif", true, 5242880L },
                    { 5, "Video", "mp4", true, 104857600L },
                    { 6, "Video", "webm", true, 104857600L },
                    { 7, "Audio", "mp3", true, 20971520L },
                    { 8, "Audio", "wav", true, 20971520L },
                    { 9, "Audio", "ogg", true, 20971520L },
                    { 10, "Document", "pdf", true, 52428800L },
                    { 11, "Document", "doc", true, 52428800L },
                    { 12, "Document", "docx", true, 52428800L },
                    { 13, "Document", "xls", true, 52428800L },
                    { 14, "Document", "xlsx", true, 52428800L },
                    { 15, "Archive", "zip", true, 104857600L },
                    { 16, "Archive", "rar", true, 104857600L }
                });

            migrationBuilder.InsertData(
                table: "SystemSettings",
                columns: new[] { "Id", "Category", "Description", "Key", "UpdatedAt", "UpdatedByAdminId", "Value" },
                values: new object[,]
                {
                    { 1, "General", "نوع احراز هویت: Database, ActiveDirectory, ERP", "AuthenticationType", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6596), null, "Database" },
                    { 2, "General", "آیا کاربران می‌توانند گروه ایجاد کنند", "AllowUserGroupCreation", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6614), null, "true" },
                    { 3, "General", "آیا کاربران می‌توانند کانال ایجاد کنند", "AllowUserChannelCreation", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6615), null, "true" },
                    { 4, "General", "زمان مجاز ویرایش پیام (ثانیه)", "MessageEditTimeLimit", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6616), null, "3600" },
                    { 5, "General", "زمان مجاز حذف پیام (ثانیه)", "MessageDeleteTimeLimit", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6617), null, "7200" },
                    { 6, "General", "فعال بودن تماس VoIP", "VoipEnabled", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6618), null, "true" },
                    { 7, "General", "فعال بودن یکپارچگی تلگرام", "TelegramIntegrationEnabled", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6619), null, "false" },
                    { 8, "General", "حداکثر تعداد اعضای گروه", "MaxGroupMembers", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6620), null, "200" },
                    { 9, "General", "زمان انقضای کد OTP (دقیقه)", "OtpExpiryMinutes", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6621), null, "5" },
                    { 10, "General", "نام سازمان", "CompanyName", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6622), null, "سازمان" },
                    { 11, "General", "آدرس لوگوی سازمان", "CompanyLogoUrl", new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6623), null, "/images/logo.png" }
                });

            migrationBuilder.CreateIndex(
                name: "IX_AdminUsers_Username",
                table: "AdminUsers",
                column: "Username",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_Calls_ChannelId",
                table: "Calls",
                column: "ChannelId");

            migrationBuilder.CreateIndex(
                name: "IX_Calls_GroupId",
                table: "Calls",
                column: "GroupId");

            migrationBuilder.CreateIndex(
                name: "IX_Calls_InitiatorId",
                table: "Calls",
                column: "InitiatorId");

            migrationBuilder.CreateIndex(
                name: "IX_Calls_ReceiverId",
                table: "Calls",
                column: "ReceiverId");

            migrationBuilder.CreateIndex(
                name: "IX_Calls_StartedAt",
                table: "Calls",
                column: "StartedAt");

            migrationBuilder.CreateIndex(
                name: "IX_Channels_CreatorId",
                table: "Channels",
                column: "CreatorId");

            migrationBuilder.CreateIndex(
                name: "IX_FileAttachments_CreatedAt",
                table: "FileAttachments",
                column: "CreatedAt");

            migrationBuilder.CreateIndex(
                name: "IX_FileAttachments_FileHash",
                table: "FileAttachments",
                column: "FileHash");

            migrationBuilder.CreateIndex(
                name: "IX_FileAttachments_MessageId",
                table: "FileAttachments",
                column: "MessageId");

            migrationBuilder.CreateIndex(
                name: "IX_FileAttachments_UploaderId",
                table: "FileAttachments",
                column: "UploaderId");

            migrationBuilder.CreateIndex(
                name: "IX_FileUploadSettings_FileType",
                table: "FileUploadSettings",
                column: "FileType",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_ForbiddenWords_Word",
                table: "ForbiddenWords",
                column: "Word",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_GroupMembers_GroupId",
                table: "GroupMembers",
                column: "GroupId");

            migrationBuilder.CreateIndex(
                name: "IX_GroupMembers_UserId_GroupId",
                table: "GroupMembers",
                columns: new[] { "UserId", "GroupId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_Groups_CreatorId",
                table: "Groups",
                column: "CreatorId");

            migrationBuilder.CreateIndex(
                name: "IX_LoginLogs_CreatedAt",
                table: "LoginLogs",
                column: "CreatedAt");

            migrationBuilder.CreateIndex(
                name: "IX_LoginLogs_UserId",
                table: "LoginLogs",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_LoginLogs_UserId1",
                table: "LoginLogs",
                column: "UserId1");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReactions_MessageId_UserId_Emoji",
                table: "MessageReactions",
                columns: new[] { "MessageId", "UserId", "Emoji" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_MessageReactions_UserId",
                table: "MessageReactions",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReactions_UserId1",
                table: "MessageReactions",
                column: "UserId1");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReads_MessageId_UserId",
                table: "MessageReads",
                columns: new[] { "MessageId", "UserId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_MessageReads_UserId",
                table: "MessageReads",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReports_MessageId",
                table: "MessageReports",
                column: "MessageId");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReports_ReporterId",
                table: "MessageReports",
                column: "ReporterId");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReports_ReviewedByAdminId",
                table: "MessageReports",
                column: "ReviewedByAdminId");

            migrationBuilder.CreateIndex(
                name: "IX_MessageReports_UserId",
                table: "MessageReports",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_CallId",
                table: "Messages",
                column: "CallId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_ChannelId",
                table: "Messages",
                column: "ChannelId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_CreatedAt",
                table: "Messages",
                column: "CreatedAt");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_ForwardedFromMessageId",
                table: "Messages",
                column: "ForwardedFromMessageId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_GroupId",
                table: "Messages",
                column: "GroupId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_ReceiverId",
                table: "Messages",
                column: "ReceiverId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_ReplyToMessageId",
                table: "Messages",
                column: "ReplyToMessageId");

            migrationBuilder.CreateIndex(
                name: "IX_Messages_SenderId",
                table: "Messages",
                column: "SenderId");

            migrationBuilder.CreateIndex(
                name: "IX_PollOptions_PollId",
                table: "PollOptions",
                column: "PollId");

            migrationBuilder.CreateIndex(
                name: "IX_Polls_ChannelId",
                table: "Polls",
                column: "ChannelId");

            migrationBuilder.CreateIndex(
                name: "IX_Polls_CreatorId",
                table: "Polls",
                column: "CreatorId");

            migrationBuilder.CreateIndex(
                name: "IX_Polls_GroupId",
                table: "Polls",
                column: "GroupId");

            migrationBuilder.CreateIndex(
                name: "IX_PollVotes_PollOptionId_UserId",
                table: "PollVotes",
                columns: new[] { "PollOptionId", "UserId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_PollVotes_UserId",
                table: "PollVotes",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReportedChannelId",
                table: "Reports",
                column: "ReportedChannelId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReportedGroupId",
                table: "Reports",
                column: "ReportedGroupId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReportedMessageId",
                table: "Reports",
                column: "ReportedMessageId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReportedUserId",
                table: "Reports",
                column: "ReportedUserId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReporterId",
                table: "Reports",
                column: "ReporterId");

            migrationBuilder.CreateIndex(
                name: "IX_Reports_ReviewedByAdminId1",
                table: "Reports",
                column: "ReviewedByAdminId1");

            migrationBuilder.CreateIndex(
                name: "IX_ServiceLinks_CreatedByAdminId",
                table: "ServiceLinks",
                column: "CreatedByAdminId");

            migrationBuilder.CreateIndex(
                name: "IX_SmsCreditLogs_CreatedAt",
                table: "SmsCreditLogs",
                column: "CreatedAt");

            migrationBuilder.CreateIndex(
                name: "IX_SmsCreditLogs_RelatedMessageId",
                table: "SmsCreditLogs",
                column: "RelatedMessageId");

            migrationBuilder.CreateIndex(
                name: "IX_SmsCreditLogs_UserId",
                table: "SmsCreditLogs",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_SmsCreditLogs_UserId1",
                table: "SmsCreditLogs",
                column: "UserId1");

            migrationBuilder.CreateIndex(
                name: "IX_StarredMessages_MessageId",
                table: "StarredMessages",
                column: "MessageId");

            migrationBuilder.CreateIndex(
                name: "IX_StarredMessages_UserId_MessageId",
                table: "StarredMessages",
                columns: new[] { "UserId", "MessageId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_StarredMessages_UserId1",
                table: "StarredMessages",
                column: "UserId1");

            migrationBuilder.CreateIndex(
                name: "IX_SystemNotifications_SenderId",
                table: "SystemNotifications",
                column: "SenderId");

            migrationBuilder.CreateIndex(
                name: "IX_SystemSettings_Key",
                table: "SystemSettings",
                column: "Key",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_SystemSettings_UpdatedByAdminId",
                table: "SystemSettings",
                column: "UpdatedByAdminId");

            migrationBuilder.CreateIndex(
                name: "IX_TelegramMessages_TelegramChatId",
                table: "TelegramMessages",
                column: "TelegramChatId");

            migrationBuilder.CreateIndex(
                name: "IX_TelegramMessages_UserId",
                table: "TelegramMessages",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_UserChannels_ChannelId",
                table: "UserChannels",
                column: "ChannelId");

            migrationBuilder.CreateIndex(
                name: "IX_UserChannels_UserId_ChannelId",
                table: "UserChannels",
                columns: new[] { "UserId", "ChannelId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_UserGroups_GroupId",
                table: "UserGroups",
                column: "GroupId");

            migrationBuilder.CreateIndex(
                name: "IX_UserGroups_UserId_GroupId",
                table: "UserGroups",
                columns: new[] { "UserId", "GroupId" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_UserPermissions_UserId",
                table: "UserPermissions",
                column: "UserId");

            migrationBuilder.CreateIndex(
                name: "IX_Users_PhoneNumber",
                table: "Users",
                column: "PhoneNumber",
                unique: true,
                filter: "[PhoneNumber] IS NOT NULL");

            migrationBuilder.CreateIndex(
                name: "IX_Users_Username",
                table: "Users",
                column: "Username",
                unique: true);
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "FileAttachments");

            migrationBuilder.DropTable(
                name: "FileUploadSettings");

            migrationBuilder.DropTable(
                name: "ForbiddenWords");

            migrationBuilder.DropTable(
                name: "GroupMembers");

            migrationBuilder.DropTable(
                name: "LoginLogs");

            migrationBuilder.DropTable(
                name: "MessageReactions");

            migrationBuilder.DropTable(
                name: "MessageReads");

            migrationBuilder.DropTable(
                name: "MessageReports");

            migrationBuilder.DropTable(
                name: "PollVotes");

            migrationBuilder.DropTable(
                name: "Reports");

            migrationBuilder.DropTable(
                name: "ServiceLinks");

            migrationBuilder.DropTable(
                name: "SmsCreditLogs");

            migrationBuilder.DropTable(
                name: "StarredMessages");

            migrationBuilder.DropTable(
                name: "SystemNotifications");

            migrationBuilder.DropTable(
                name: "SystemSettings");

            migrationBuilder.DropTable(
                name: "TelegramMessages");

            migrationBuilder.DropTable(
                name: "UserChannels");

            migrationBuilder.DropTable(
                name: "UserGroups");

            migrationBuilder.DropTable(
                name: "UserPermissions");

            migrationBuilder.DropTable(
                name: "PollOptions");

            migrationBuilder.DropTable(
                name: "Messages");

            migrationBuilder.DropTable(
                name: "AdminUsers");

            migrationBuilder.DropTable(
                name: "Polls");

            migrationBuilder.DropTable(
                name: "Calls");

            migrationBuilder.DropTable(
                name: "Channels");

            migrationBuilder.DropTable(
                name: "Groups");

            migrationBuilder.DropTable(
                name: "Users");
        }
    }
}
 
 
==================== 20260209061809_initDB.Designer.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿// <auto-generated />
using System;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using OrganizationalMessenger.Infrastructure.Data;

#nullable disable

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    [DbContext(typeof(ApplicationDbContext))]
    [Migration("20260209061809_initDB")]
    partial class initDB
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.23")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.AdminUser", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastLoginAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("AdminUsers");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            CreatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 65, DateTimeKind.Local).AddTicks(9793),
                            Email = "admin@company.com",
                            FirstName = "مدیر",
                            IsActive = true,
                            LastName = "سیستم",
                            PasswordHash = "$2a$11$9t1CsubdkLWzCxr5Nf2TvOGRMtSnqC.7Y2/jbkJXRIXFOrAw8nQby",
                            Username = "admin"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DestinationType")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<DateTime?>("EndedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<int>("InitiatorId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("MeetingLink")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("MeetingPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StartedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("GroupId");

                    b.HasIndex("InitiatorId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("StartedAt");

                    b.ToTable("Calls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowComments")
                        .HasColumnType("bit");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("InviteLink")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPrivate")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MemberCount")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<bool>("OnlyAdminsCanPost")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Channels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ContentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DownloadCount")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<string>("Extension")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<string>("FileHash")
                        .HasMaxLength(64)
                        .HasColumnType("nvarchar(64)");

                    b.Property<string>("FileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("FilePath")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<long>("FileSize")
                        .HasColumnType("bigint");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("Height")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSafe")
                        .HasColumnType("bit");

                    b.Property<bool>("IsScanned")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastDownloadAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("MessageId")
                        .HasColumnType("int");

                    b.Property<string>("OriginalFileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("ScanResult")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("ScannedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("ThumbnailPath")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("ThumbnailUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UploaderId")
                        .HasColumnType("int");

                    b.Property<int?>("Width")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("FileHash");

                    b.HasIndex("MessageId");

                    b.HasIndex("UploaderId");

                    b.ToTable("FileAttachments");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileUploadSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsAllowed")
                        .HasColumnType("bit");

                    b.Property<long>("MaxSize")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("FileType")
                        .IsUnique();

                    b.ToTable("FileUploadSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "Image",
                            FileType = "jpg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 2,
                            Category = "Image",
                            FileType = "jpeg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 3,
                            Category = "Image",
                            FileType = "png",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 4,
                            Category = "Image",
                            FileType = "gif",
                            IsAllowed = true,
                            MaxSize = 5242880L
                        },
                        new
                        {
                            Id = 5,
                            Category = "Video",
                            FileType = "mp4",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 6,
                            Category = "Video",
                            FileType = "webm",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 7,
                            Category = "Audio",
                            FileType = "mp3",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 8,
                            Category = "Audio",
                            FileType = "wav",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 9,
                            Category = "Audio",
                            FileType = "ogg",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 10,
                            Category = "Document",
                            FileType = "pdf",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 11,
                            Category = "Document",
                            FileType = "doc",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 12,
                            Category = "Document",
                            FileType = "docx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 13,
                            Category = "Document",
                            FileType = "xls",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 14,
                            Category = "Document",
                            FileType = "xlsx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 15,
                            Category = "Archive",
                            FileType = "zip",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 16,
                            Category = "Archive",
                            FileType = "rar",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ForbiddenWord", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<string>("Word")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Word")
                        .IsUnique();

                    b.ToTable("ForbiddenWords");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MaxMembers")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Groups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("GroupMembers");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("AuthType")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("FailureReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("IpAddress")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsSuccessful")
                        .HasColumnType("bit");

                    b.Property<string>("UserAgent")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("LoginLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentName")
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<long?>("AttachmentSize")
                        .HasColumnType("bigint");

                    b.Property<string>("AttachmentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("CallId")
                        .HasColumnType("int");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeliveredAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("EditedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("EncryptedContent")
                        .HasMaxLength(8000)
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ForwardedFromMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDelivered")
                        .HasColumnType("bit");

                    b.Property<bool>("IsEdited")
                        .HasColumnType("bit");

                    b.Property<bool>("IsRead")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSystemMessage")
                        .HasColumnType("bit");

                    b.Property<string>("MessageText")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("ReadAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<int?>("ReplyToMessageId")
                        .HasColumnType("int");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<DateTime>("SentAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CallId");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ForwardedFromMessageId");

                    b.HasIndex("GroupId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("ReplyToMessageId");

                    b.HasIndex("SenderId");

                    b.ToTable("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Emoji")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.HasIndex("MessageId", "UserId", "Emoji")
                        .IsUnique();

                    b.ToTable("MessageReactions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("ReadAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("MessageId", "UserId")
                        .IsUnique();

                    b.ToTable("MessageReads");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<bool>("IsReviewed")
                        .HasColumnType("bit");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("ReviewedByAdminId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId");

                    b.HasIndex("UserId");

                    b.ToTable("MessageReports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowMultipleAnswers")
                        .HasColumnType("bit");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAnonymous")
                        .HasColumnType("bit");

                    b.Property<string>("Question")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatorId");

                    b.HasIndex("GroupId");

                    b.ToTable("Polls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<int>("PollId")
                        .HasColumnType("int");

                    b.Property<string>("Text")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("PollId");

                    b.ToTable("PollOptions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("PollOptionId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<DateTime>("VotedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("PollOptionId", "UserId")
                        .IsUnique();

                    b.ToTable("PollVotes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AdminNote")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("ItemType")
                        .HasColumnType("int");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ReportedChannelId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedGroupId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedUserId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("ReviewedByAdminId")
                        .HasColumnType("bigint");

                    b.Property<int?>("ReviewedByAdminId1")
                        .HasColumnType("int");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ReportedChannelId");

                    b.HasIndex("ReportedGroupId");

                    b.HasIndex("ReportedMessageId");

                    b.HasIndex("ReportedUserId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId1");

                    b.ToTable("Reports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<string>("IconClass")
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("IconUrl")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("OpenInNewTab")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("Url")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("CreatedByAdminId");

                    b.ToTable("ServiceLinks");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Amount")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("RelatedMessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("RelatedMessageId");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("SmsCreditLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StarredAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("UserId1");

                    b.HasIndex("UserId", "MessageId")
                        .IsUnique();

                    b.ToTable("StarredMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("nvarchar(2000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("SendImmediately")
                        .HasColumnType("bit");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<bool>("ShowOnLogin")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("SenderId");

                    b.ToTable("SystemNotifications");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("UpdatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Value")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.HasKey("Id");

                    b.HasIndex("Key")
                        .IsUnique();

                    b.HasIndex("UpdatedByAdminId");

                    b.ToTable("SystemSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "General",
                            Description = "نوع احراز هویت: Database, ActiveDirectory, ERP",
                            Key = "AuthenticationType",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6596),
                            Value = "Database"
                        },
                        new
                        {
                            Id = 2,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند گروه ایجاد کنند",
                            Key = "AllowUserGroupCreation",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6614),
                            Value = "true"
                        },
                        new
                        {
                            Id = 3,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند کانال ایجاد کنند",
                            Key = "AllowUserChannelCreation",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6615),
                            Value = "true"
                        },
                        new
                        {
                            Id = 4,
                            Category = "General",
                            Description = "زمان مجاز ویرایش پیام (ثانیه)",
                            Key = "MessageEditTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6616),
                            Value = "3600"
                        },
                        new
                        {
                            Id = 5,
                            Category = "General",
                            Description = "زمان مجاز حذف پیام (ثانیه)",
                            Key = "MessageDeleteTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6617),
                            Value = "7200"
                        },
                        new
                        {
                            Id = 6,
                            Category = "General",
                            Description = "فعال بودن تماس VoIP",
                            Key = "VoipEnabled",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6618),
                            Value = "true"
                        },
                        new
                        {
                            Id = 7,
                            Category = "General",
                            Description = "فعال بودن یکپارچگی تلگرام",
                            Key = "TelegramIntegrationEnabled",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6619),
                            Value = "false"
                        },
                        new
                        {
                            Id = 8,
                            Category = "General",
                            Description = "حداکثر تعداد اعضای گروه",
                            Key = "MaxGroupMembers",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6620),
                            Value = "200"
                        },
                        new
                        {
                            Id = 9,
                            Category = "General",
                            Description = "زمان انقضای کد OTP (دقیقه)",
                            Key = "OtpExpiryMinutes",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6621),
                            Value = "5"
                        },
                        new
                        {
                            Id = 10,
                            Category = "General",
                            Description = "نام سازمان",
                            Key = "CompanyName",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6622),
                            Value = "سازمان"
                        },
                        new
                        {
                            Id = 11,
                            Category = "General",
                            Description = "آدرس لوگوی سازمان",
                            Key = "CompanyLogoUrl",
                            UpdatedAt = new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6623),
                            Value = "/images/logo.png"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsIncoming")
                        .HasColumnType("bit");

                    b.Property<bool>("IsRead")
                        .HasColumnType("bit");

                    b.Property<string>("TelegramChatId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("TelegramUsername")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("TelegramChatId");

                    b.HasIndex("UserId");

                    b.ToTable("TelegramMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ActiveDirectoryId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Bio")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("BlockReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("BlockedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVideoCall")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVoiceCall")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("ErpUserId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsADAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsBlocked")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsErpAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOnline")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOtpVerified")
                        .HasColumnType("bit");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("LastSeen")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("LastSeenAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("OtpCode")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<DateTime?>("OtpExpireTime")
                        .HasColumnType("datetime2");

                    b.Property<string>("PasswordHash")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PhoneNumber")
                        .HasMaxLength(20)
                        .HasColumnType("nvarchar(20)");

                    b.Property<string>("ProfilePicture")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PublicKey")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("RefreshToken")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("RefreshTokenExpiry")
                        .HasColumnType("datetime2");

                    b.Property<bool>("ShowPreview")
                        .HasColumnType("bit");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<bool>("SoundEnabled")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("VoipEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("VoipExtension")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("VoipPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("PhoneNumber")
                        .IsUnique()
                        .HasFilter("[PhoneNumber] IS NOT NULL");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("Users");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanDeleteMessages")
                        .HasColumnType("bit");

                    b.Property<bool>("CanManageMembers")
                        .HasColumnType("bit");

                    b.Property<bool>("CanPost")
                        .HasColumnType("bit");

                    b.Property<int>("ChannelId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOwner")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPinned")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("LastReadMessageId")
                        .HasColumnType("bigint");

                    b.Property<DateTime?>("LeftAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UnreadCount")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("UserId", "ChannelId")
                        .IsUnique();

                    b.ToTable("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreatePoll")
                        .HasColumnType("bit");

                    b.Property<bool>("CanSendBroadcast")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseTelegram")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseVoIP")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditUsedThisYear")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditYear")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<string>("VoIPExtension")
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("UserPermissions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Calls")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Calls")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Initiator")
                        .WithMany("InitiatedCalls")
                        .HasForeignKey("InitiatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedCalls")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("Channel");

                    b.Navigation("Group");

                    b.Navigation("Initiator");

                    b.Navigation("Receiver");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedChannels")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Attachments")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Uploader")
                        .WithMany("UploadedFiles")
                        .HasForeignKey("UploaderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("Uploader");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedGroups")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Members")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("LoginLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Call", "Call")
                        .WithMany("Messages")
                        .HasForeignKey("CallId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Messages")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ForwardedFromMessage")
                        .WithMany()
                        .HasForeignKey("ForwardedFromMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Messages")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedMessages")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReplyToMessage")
                        .WithMany("Replies")
                        .HasForeignKey("ReplyToMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany("SentMessages")
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Call");

                    b.Navigation("Channel");

                    b.Navigation("ForwardedFromMessage");

                    b.Navigation("Group");

                    b.Navigation("Receiver");

                    b.Navigation("ReplyToMessage");

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Reactions")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("Reactions")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("ReadReceipts")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("MessageReports")
                        .HasForeignKey("UserId");

                    b.Navigation("Message");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany()
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany()
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.Navigation("Channel");

                    b.Navigation("Creator");

                    b.Navigation("Group");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Poll", "Poll")
                        .WithMany("Options")
                        .HasForeignKey("PollId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Poll");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.PollOption", "PollOption")
                        .WithMany("Votes")
                        .HasForeignKey("PollOptionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("PollOption");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "ReportedChannel")
                        .WithMany()
                        .HasForeignKey("ReportedChannelId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "ReportedGroup")
                        .WithMany()
                        .HasForeignKey("ReportedGroupId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReportedMessage")
                        .WithMany()
                        .HasForeignKey("ReportedMessageId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReportedUser")
                        .WithMany()
                        .HasForeignKey("ReportedUserId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId1");

                    b.Navigation("ReportedChannel");

                    b.Navigation("ReportedGroup");

                    b.Navigation("ReportedMessage");

                    b.Navigation("ReportedUser");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "CreatedByAdmin")
                        .WithMany()
                        .HasForeignKey("CreatedByAdminId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CreatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "RelatedMessage")
                        .WithMany()
                        .HasForeignKey("RelatedMessageId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("SmsCreditLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("RelatedMessage");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("StarredMessages")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany()
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "UpdatedByAdmin")
                        .WithMany()
                        .HasForeignKey("UpdatedByAdminId");

                    b.Navigation("UpdatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("UserChannels")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserChannels")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Channel");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("UserGroups")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserGroups")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Navigation("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Messages");

                    b.Navigation("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Members");

                    b.Navigation("Messages");

                    b.Navigation("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Navigation("Attachments");

                    b.Navigation("Reactions");

                    b.Navigation("ReadReceipts");

                    b.Navigation("Replies");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Navigation("Options");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Navigation("Votes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Navigation("CreatedChannels");

                    b.Navigation("CreatedGroups");

                    b.Navigation("InitiatedCalls");

                    b.Navigation("LoginLogs");

                    b.Navigation("MessageReports");

                    b.Navigation("Reactions");

                    b.Navigation("ReceivedCalls");

                    b.Navigation("ReceivedMessages");

                    b.Navigation("SentMessages");

                    b.Navigation("SmsCreditLogs");

                    b.Navigation("StarredMessages");

                    b.Navigation("UploadedFiles");

                    b.Navigation("UserChannels");

                    b.Navigation("UserGroups");
                });
#pragma warning restore 612, 618
        }
    }
}
 
 
==================== 20260210103130_RemoveIsRead.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    /// <inheritdoc />
    public partial class RemoveIsRead : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "IsRead",
                table: "Messages");

            migrationBuilder.DropColumn(
                name: "ReadAt",
                table: "Messages");

            migrationBuilder.UpdateData(
                table: "AdminUsers",
                keyColumn: "Id",
                keyValue: 1,
                columns: new[] { "CreatedAt", "PasswordHash" },
                values: new object[] { new DateTime(2026, 2, 10, 14, 1, 27, 111, DateTimeKind.Local).AddTicks(3959), "$2a$11$YEsn4oADy3r3FV42dIufneNTPQ2hBYH3Ke9sfQl784pc8RD6j6pBe" });

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 1,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7222));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 2,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7241));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 3,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7242));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 4,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7243));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 5,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7244));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 6,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7245));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 7,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7247));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 8,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7248));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 9,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7249));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 10,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7250));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 11,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7252));
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AddColumn<bool>(
                name: "IsRead",
                table: "Messages",
                type: "bit",
                nullable: false,
                defaultValue: false);

            migrationBuilder.AddColumn<DateTime>(
                name: "ReadAt",
                table: "Messages",
                type: "datetime2",
                nullable: true);

            migrationBuilder.UpdateData(
                table: "AdminUsers",
                keyColumn: "Id",
                keyValue: 1,
                columns: new[] { "CreatedAt", "PasswordHash" },
                values: new object[] { new DateTime(2026, 2, 9, 9, 48, 8, 65, DateTimeKind.Local).AddTicks(9793), "$2a$11$9t1CsubdkLWzCxr5Nf2TvOGRMtSnqC.7Y2/jbkJXRIXFOrAw8nQby" });

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 1,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6596));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 2,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6614));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 3,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6615));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 4,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6616));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 5,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6617));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 6,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6618));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 7,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6619));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 8,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6620));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 9,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6621));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 10,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6622));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 11,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 9, 9, 48, 8, 103, DateTimeKind.Local).AddTicks(6623));
        }
    }
}
 
 
==================== 20260210103130_RemoveIsRead.Designer.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿// <auto-generated />
using System;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using OrganizationalMessenger.Infrastructure.Data;

#nullable disable

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    [DbContext(typeof(ApplicationDbContext))]
    [Migration("20260210103130_RemoveIsRead")]
    partial class RemoveIsRead
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.23")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.AdminUser", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastLoginAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("AdminUsers");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            CreatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 111, DateTimeKind.Local).AddTicks(3959),
                            Email = "admin@company.com",
                            FirstName = "مدیر",
                            IsActive = true,
                            LastName = "سیستم",
                            PasswordHash = "$2a$11$YEsn4oADy3r3FV42dIufneNTPQ2hBYH3Ke9sfQl784pc8RD6j6pBe",
                            Username = "admin"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DestinationType")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<DateTime?>("EndedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<int>("InitiatorId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("MeetingLink")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("MeetingPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StartedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("GroupId");

                    b.HasIndex("InitiatorId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("StartedAt");

                    b.ToTable("Calls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowComments")
                        .HasColumnType("bit");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("InviteLink")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPrivate")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MemberCount")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<bool>("OnlyAdminsCanPost")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Channels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ContentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DownloadCount")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<string>("Extension")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<string>("FileHash")
                        .HasMaxLength(64)
                        .HasColumnType("nvarchar(64)");

                    b.Property<string>("FileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("FilePath")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<long>("FileSize")
                        .HasColumnType("bigint");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("Height")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSafe")
                        .HasColumnType("bit");

                    b.Property<bool>("IsScanned")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastDownloadAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("MessageId")
                        .HasColumnType("int");

                    b.Property<string>("OriginalFileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("ScanResult")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("ScannedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("ThumbnailPath")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("ThumbnailUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UploaderId")
                        .HasColumnType("int");

                    b.Property<int?>("Width")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("FileHash");

                    b.HasIndex("MessageId");

                    b.HasIndex("UploaderId");

                    b.ToTable("FileAttachments");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileUploadSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsAllowed")
                        .HasColumnType("bit");

                    b.Property<long>("MaxSize")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("FileType")
                        .IsUnique();

                    b.ToTable("FileUploadSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "Image",
                            FileType = "jpg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 2,
                            Category = "Image",
                            FileType = "jpeg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 3,
                            Category = "Image",
                            FileType = "png",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 4,
                            Category = "Image",
                            FileType = "gif",
                            IsAllowed = true,
                            MaxSize = 5242880L
                        },
                        new
                        {
                            Id = 5,
                            Category = "Video",
                            FileType = "mp4",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 6,
                            Category = "Video",
                            FileType = "webm",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 7,
                            Category = "Audio",
                            FileType = "mp3",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 8,
                            Category = "Audio",
                            FileType = "wav",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 9,
                            Category = "Audio",
                            FileType = "ogg",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 10,
                            Category = "Document",
                            FileType = "pdf",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 11,
                            Category = "Document",
                            FileType = "doc",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 12,
                            Category = "Document",
                            FileType = "docx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 13,
                            Category = "Document",
                            FileType = "xls",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 14,
                            Category = "Document",
                            FileType = "xlsx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 15,
                            Category = "Archive",
                            FileType = "zip",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 16,
                            Category = "Archive",
                            FileType = "rar",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ForbiddenWord", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<string>("Word")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Word")
                        .IsUnique();

                    b.ToTable("ForbiddenWords");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MaxMembers")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Groups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("GroupMembers");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("AuthType")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("FailureReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("IpAddress")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsSuccessful")
                        .HasColumnType("bit");

                    b.Property<string>("UserAgent")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("LoginLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentName")
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<long?>("AttachmentSize")
                        .HasColumnType("bigint");

                    b.Property<string>("AttachmentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("CallId")
                        .HasColumnType("int");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeliveredAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("EditedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("EncryptedContent")
                        .HasMaxLength(8000)
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ForwardedFromMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDelivered")
                        .HasColumnType("bit");

                    b.Property<bool>("IsEdited")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSystemMessage")
                        .HasColumnType("bit");

                    b.Property<string>("MessageText")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<int?>("ReplyToMessageId")
                        .HasColumnType("int");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<DateTime>("SentAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CallId");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ForwardedFromMessageId");

                    b.HasIndex("GroupId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("ReplyToMessageId");

                    b.HasIndex("SenderId");

                    b.ToTable("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Emoji")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.HasIndex("MessageId", "UserId", "Emoji")
                        .IsUnique();

                    b.ToTable("MessageReactions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("ReadAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("MessageId", "UserId")
                        .IsUnique();

                    b.ToTable("MessageReads");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<bool>("IsReviewed")
                        .HasColumnType("bit");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("ReviewedByAdminId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId");

                    b.HasIndex("UserId");

                    b.ToTable("MessageReports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowMultipleAnswers")
                        .HasColumnType("bit");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAnonymous")
                        .HasColumnType("bit");

                    b.Property<string>("Question")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatorId");

                    b.HasIndex("GroupId");

                    b.ToTable("Polls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<int>("PollId")
                        .HasColumnType("int");

                    b.Property<string>("Text")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("PollId");

                    b.ToTable("PollOptions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("PollOptionId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<DateTime>("VotedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("PollOptionId", "UserId")
                        .IsUnique();

                    b.ToTable("PollVotes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AdminNote")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("ItemType")
                        .HasColumnType("int");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ReportedChannelId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedGroupId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedUserId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("ReviewedByAdminId")
                        .HasColumnType("bigint");

                    b.Property<int?>("ReviewedByAdminId1")
                        .HasColumnType("int");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ReportedChannelId");

                    b.HasIndex("ReportedGroupId");

                    b.HasIndex("ReportedMessageId");

                    b.HasIndex("ReportedUserId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId1");

                    b.ToTable("Reports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<string>("IconClass")
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("IconUrl")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("OpenInNewTab")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("Url")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("CreatedByAdminId");

                    b.ToTable("ServiceLinks");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Amount")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("RelatedMessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("RelatedMessageId");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("SmsCreditLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StarredAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("UserId1");

                    b.HasIndex("UserId", "MessageId")
                        .IsUnique();

                    b.ToTable("StarredMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("nvarchar(2000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("SendImmediately")
                        .HasColumnType("bit");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<bool>("ShowOnLogin")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("SenderId");

                    b.ToTable("SystemNotifications");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("UpdatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Value")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.HasKey("Id");

                    b.HasIndex("Key")
                        .IsUnique();

                    b.HasIndex("UpdatedByAdminId");

                    b.ToTable("SystemSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "General",
                            Description = "نوع احراز هویت: Database, ActiveDirectory, ERP",
                            Key = "AuthenticationType",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7222),
                            Value = "Database"
                        },
                        new
                        {
                            Id = 2,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند گروه ایجاد کنند",
                            Key = "AllowUserGroupCreation",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7241),
                            Value = "true"
                        },
                        new
                        {
                            Id = 3,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند کانال ایجاد کنند",
                            Key = "AllowUserChannelCreation",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7242),
                            Value = "true"
                        },
                        new
                        {
                            Id = 4,
                            Category = "General",
                            Description = "زمان مجاز ویرایش پیام (ثانیه)",
                            Key = "MessageEditTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7243),
                            Value = "3600"
                        },
                        new
                        {
                            Id = 5,
                            Category = "General",
                            Description = "زمان مجاز حذف پیام (ثانیه)",
                            Key = "MessageDeleteTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7244),
                            Value = "7200"
                        },
                        new
                        {
                            Id = 6,
                            Category = "General",
                            Description = "فعال بودن تماس VoIP",
                            Key = "VoipEnabled",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7245),
                            Value = "true"
                        },
                        new
                        {
                            Id = 7,
                            Category = "General",
                            Description = "فعال بودن یکپارچگی تلگرام",
                            Key = "TelegramIntegrationEnabled",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7247),
                            Value = "false"
                        },
                        new
                        {
                            Id = 8,
                            Category = "General",
                            Description = "حداکثر تعداد اعضای گروه",
                            Key = "MaxGroupMembers",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7248),
                            Value = "200"
                        },
                        new
                        {
                            Id = 9,
                            Category = "General",
                            Description = "زمان انقضای کد OTP (دقیقه)",
                            Key = "OtpExpiryMinutes",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7249),
                            Value = "5"
                        },
                        new
                        {
                            Id = 10,
                            Category = "General",
                            Description = "نام سازمان",
                            Key = "CompanyName",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7250),
                            Value = "سازمان"
                        },
                        new
                        {
                            Id = 11,
                            Category = "General",
                            Description = "آدرس لوگوی سازمان",
                            Key = "CompanyLogoUrl",
                            UpdatedAt = new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7252),
                            Value = "/images/logo.png"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsIncoming")
                        .HasColumnType("bit");

                    b.Property<bool>("IsRead")
                        .HasColumnType("bit");

                    b.Property<string>("TelegramChatId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("TelegramUsername")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("TelegramChatId");

                    b.HasIndex("UserId");

                    b.ToTable("TelegramMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ActiveDirectoryId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Bio")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("BlockReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("BlockedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVideoCall")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVoiceCall")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("ErpUserId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsADAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsBlocked")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsErpAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOnline")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOtpVerified")
                        .HasColumnType("bit");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("LastSeen")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("LastSeenAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("OtpCode")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<DateTime?>("OtpExpireTime")
                        .HasColumnType("datetime2");

                    b.Property<string>("PasswordHash")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PhoneNumber")
                        .HasMaxLength(20)
                        .HasColumnType("nvarchar(20)");

                    b.Property<string>("ProfilePicture")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PublicKey")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("RefreshToken")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("RefreshTokenExpiry")
                        .HasColumnType("datetime2");

                    b.Property<bool>("ShowPreview")
                        .HasColumnType("bit");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<bool>("SoundEnabled")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("VoipEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("VoipExtension")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("VoipPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("PhoneNumber")
                        .IsUnique()
                        .HasFilter("[PhoneNumber] IS NOT NULL");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("Users");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanDeleteMessages")
                        .HasColumnType("bit");

                    b.Property<bool>("CanManageMembers")
                        .HasColumnType("bit");

                    b.Property<bool>("CanPost")
                        .HasColumnType("bit");

                    b.Property<int>("ChannelId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOwner")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPinned")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("LastReadMessageId")
                        .HasColumnType("bigint");

                    b.Property<DateTime?>("LeftAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UnreadCount")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("UserId", "ChannelId")
                        .IsUnique();

                    b.ToTable("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreatePoll")
                        .HasColumnType("bit");

                    b.Property<bool>("CanSendBroadcast")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseTelegram")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseVoIP")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditUsedThisYear")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditYear")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<string>("VoIPExtension")
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("UserPermissions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Calls")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Calls")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Initiator")
                        .WithMany("InitiatedCalls")
                        .HasForeignKey("InitiatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedCalls")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("Channel");

                    b.Navigation("Group");

                    b.Navigation("Initiator");

                    b.Navigation("Receiver");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedChannels")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Attachments")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Uploader")
                        .WithMany("UploadedFiles")
                        .HasForeignKey("UploaderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("Uploader");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedGroups")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Members")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("LoginLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Call", "Call")
                        .WithMany("Messages")
                        .HasForeignKey("CallId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Messages")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ForwardedFromMessage")
                        .WithMany()
                        .HasForeignKey("ForwardedFromMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Messages")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedMessages")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReplyToMessage")
                        .WithMany("Replies")
                        .HasForeignKey("ReplyToMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany("SentMessages")
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Call");

                    b.Navigation("Channel");

                    b.Navigation("ForwardedFromMessage");

                    b.Navigation("Group");

                    b.Navigation("Receiver");

                    b.Navigation("ReplyToMessage");

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Reactions")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("Reactions")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("ReadReceipts")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("MessageReports")
                        .HasForeignKey("UserId");

                    b.Navigation("Message");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany()
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany()
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.Navigation("Channel");

                    b.Navigation("Creator");

                    b.Navigation("Group");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Poll", "Poll")
                        .WithMany("Options")
                        .HasForeignKey("PollId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Poll");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.PollOption", "PollOption")
                        .WithMany("Votes")
                        .HasForeignKey("PollOptionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("PollOption");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "ReportedChannel")
                        .WithMany()
                        .HasForeignKey("ReportedChannelId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "ReportedGroup")
                        .WithMany()
                        .HasForeignKey("ReportedGroupId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReportedMessage")
                        .WithMany()
                        .HasForeignKey("ReportedMessageId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReportedUser")
                        .WithMany()
                        .HasForeignKey("ReportedUserId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId1");

                    b.Navigation("ReportedChannel");

                    b.Navigation("ReportedGroup");

                    b.Navigation("ReportedMessage");

                    b.Navigation("ReportedUser");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "CreatedByAdmin")
                        .WithMany()
                        .HasForeignKey("CreatedByAdminId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CreatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "RelatedMessage")
                        .WithMany()
                        .HasForeignKey("RelatedMessageId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("SmsCreditLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("RelatedMessage");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("StarredMessages")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany()
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "UpdatedByAdmin")
                        .WithMany()
                        .HasForeignKey("UpdatedByAdminId");

                    b.Navigation("UpdatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("UserChannels")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserChannels")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Channel");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("UserGroups")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserGroups")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Navigation("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Messages");

                    b.Navigation("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Members");

                    b.Navigation("Messages");

                    b.Navigation("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Navigation("Attachments");

                    b.Navigation("Reactions");

                    b.Navigation("ReadReceipts");

                    b.Navigation("Replies");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Navigation("Options");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Navigation("Votes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Navigation("CreatedChannels");

                    b.Navigation("CreatedGroups");

                    b.Navigation("InitiatedCalls");

                    b.Navigation("LoginLogs");

                    b.Navigation("MessageReports");

                    b.Navigation("Reactions");

                    b.Navigation("ReceivedCalls");

                    b.Navigation("ReceivedMessages");

                    b.Navigation("SentMessages");

                    b.Navigation("SmsCreditLogs");

                    b.Navigation("StarredMessages");

                    b.Navigation("UploadedFiles");

                    b.Navigation("UserChannels");

                    b.Navigation("UserGroups");
                });
#pragma warning restore 612, 618
        }
    }
}
 
 
==================== 20260213121527_AddDeletedFieldsToMessage.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    /// <inheritdoc />
    public partial class AddDeletedFieldsToMessage : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AddColumn<int>(
                name: "DeletedByUserId",
                table: "Messages",
                type: "int",
                nullable: true);

            migrationBuilder.UpdateData(
                table: "AdminUsers",
                keyColumn: "Id",
                keyValue: 1,
                columns: new[] { "CreatedAt", "PasswordHash" },
                values: new object[] { new DateTime(2026, 2, 13, 15, 45, 24, 664, DateTimeKind.Local).AddTicks(1041), "$2a$11$R7gC3VDjPOrYFBE8IgjXXu/ssUNR3u/7uNYuqRPn8OVZ1VeSgjLDq" });

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 1,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7031));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 2,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7045));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 3,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7047));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 4,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7048));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 5,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7049));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 6,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7050));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 7,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7051));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 8,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7052));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 9,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7053));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 10,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7054));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 11,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7055));
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "DeletedByUserId",
                table: "Messages");

            migrationBuilder.UpdateData(
                table: "AdminUsers",
                keyColumn: "Id",
                keyValue: 1,
                columns: new[] { "CreatedAt", "PasswordHash" },
                values: new object[] { new DateTime(2026, 2, 10, 14, 1, 27, 111, DateTimeKind.Local).AddTicks(3959), "$2a$11$YEsn4oADy3r3FV42dIufneNTPQ2hBYH3Ke9sfQl784pc8RD6j6pBe" });

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 1,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7222));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 2,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7241));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 3,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7242));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 4,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7243));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 5,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7244));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 6,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7245));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 7,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7247));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 8,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7248));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 9,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7249));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 10,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7250));

            migrationBuilder.UpdateData(
                table: "SystemSettings",
                keyColumn: "Id",
                keyValue: 11,
                column: "UpdatedAt",
                value: new DateTime(2026, 2, 10, 14, 1, 27, 151, DateTimeKind.Local).AddTicks(7252));
        }
    }
}
 
 
==================== 20260213121527_AddDeletedFieldsToMessage.Designer.cs ==================== 
Path: F:\OrgMessenger\OrganizationalMessenger.Infrastructure\Migrations\ 
 
﻿// <auto-generated />
using System;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using OrganizationalMessenger.Infrastructure.Data;

#nullable disable

namespace OrganizationalMessenger.Infrastructure.Migrations
{
    [DbContext(typeof(ApplicationDbContext))]
    [Migration("20260213121527_AddDeletedFieldsToMessage")]
    partial class AddDeletedFieldsToMessage
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.23")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.AdminUser", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastLoginAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("AdminUsers");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            CreatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 664, DateTimeKind.Local).AddTicks(1041),
                            Email = "admin@company.com",
                            FirstName = "مدیر",
                            IsActive = true,
                            LastName = "سیستم",
                            PasswordHash = "$2a$11$R7gC3VDjPOrYFBE8IgjXXu/ssUNR3u/7uNYuqRPn8OVZ1VeSgjLDq",
                            Username = "admin"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DestinationType")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<DateTime?>("EndedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<int>("InitiatorId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("MeetingLink")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("MeetingPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StartedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("GroupId");

                    b.HasIndex("InitiatorId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("StartedAt");

                    b.ToTable("Calls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowComments")
                        .HasColumnType("bit");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("InviteLink")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPrivate")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MemberCount")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<bool>("OnlyAdminsCanPost")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Channels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ContentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("DownloadCount")
                        .HasColumnType("int");

                    b.Property<int?>("Duration")
                        .HasColumnType("int");

                    b.Property<string>("Extension")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<string>("FileHash")
                        .HasMaxLength(64)
                        .HasColumnType("nvarchar(64)");

                    b.Property<string>("FileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("FilePath")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<long>("FileSize")
                        .HasColumnType("bigint");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("Height")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSafe")
                        .HasColumnType("bit");

                    b.Property<bool>("IsScanned")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastDownloadAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("MessageId")
                        .HasColumnType("int");

                    b.Property<string>("OriginalFileName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<string>("ScanResult")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("ScannedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("ThumbnailPath")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("ThumbnailUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UploaderId")
                        .HasColumnType("int");

                    b.Property<int?>("Width")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("FileHash");

                    b.HasIndex("MessageId");

                    b.HasIndex("UploaderId");

                    b.ToTable("FileAttachments");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileUploadSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("FileType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsAllowed")
                        .HasColumnType("bit");

                    b.Property<long>("MaxSize")
                        .HasColumnType("bigint");

                    b.HasKey("Id");

                    b.HasIndex("FileType")
                        .IsUnique();

                    b.ToTable("FileUploadSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "Image",
                            FileType = "jpg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 2,
                            Category = "Image",
                            FileType = "jpeg",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 3,
                            Category = "Image",
                            FileType = "png",
                            IsAllowed = true,
                            MaxSize = 10485760L
                        },
                        new
                        {
                            Id = 4,
                            Category = "Image",
                            FileType = "gif",
                            IsAllowed = true,
                            MaxSize = 5242880L
                        },
                        new
                        {
                            Id = 5,
                            Category = "Video",
                            FileType = "mp4",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 6,
                            Category = "Video",
                            FileType = "webm",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 7,
                            Category = "Audio",
                            FileType = "mp3",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 8,
                            Category = "Audio",
                            FileType = "wav",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 9,
                            Category = "Audio",
                            FileType = "ogg",
                            IsAllowed = true,
                            MaxSize = 20971520L
                        },
                        new
                        {
                            Id = 10,
                            Category = "Document",
                            FileType = "pdf",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 11,
                            Category = "Document",
                            FileType = "doc",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 12,
                            Category = "Document",
                            FileType = "docx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 13,
                            Category = "Document",
                            FileType = "xls",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 14,
                            Category = "Document",
                            FileType = "xlsx",
                            IsAllowed = true,
                            MaxSize = 52428800L
                        },
                        new
                        {
                            Id = 15,
                            Category = "Archive",
                            FileType = "zip",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        },
                        new
                        {
                            Id = 16,
                            Category = "Archive",
                            FileType = "rar",
                            IsAllowed = true,
                            MaxSize = 104857600L
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ForbiddenWord", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<string>("Word")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("Word")
                        .IsUnique();

                    b.ToTable("ForbiddenWords");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPublic")
                        .HasColumnType("bit");

                    b.Property<int>("MaxMembers")
                        .HasColumnType("int");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CreatorId");

                    b.ToTable("Groups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("GroupMembers");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("AuthType")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("FailureReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("IpAddress")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<bool>("IsSuccessful")
                        .HasColumnType("bit");

                    b.Property<string>("UserAgent")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("LoginLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentName")
                        .HasMaxLength(255)
                        .HasColumnType("nvarchar(255)");

                    b.Property<long?>("AttachmentSize")
                        .HasColumnType("bigint");

                    b.Property<string>("AttachmentType")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("CallId")
                        .HasColumnType("int");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("DeletedByUserId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("DeliveredAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("EditedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("EncryptedContent")
                        .HasMaxLength(8000)
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ForwardedFromMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDelivered")
                        .HasColumnType("bit");

                    b.Property<bool>("IsEdited")
                        .HasColumnType("bit");

                    b.Property<bool>("IsSystemMessage")
                        .HasColumnType("bit");

                    b.Property<string>("MessageText")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ReceiverId")
                        .HasColumnType("int");

                    b.Property<int?>("ReplyToMessageId")
                        .HasColumnType("int");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<DateTime>("SentAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("Type")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CallId");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ForwardedFromMessageId");

                    b.HasIndex("GroupId");

                    b.HasIndex("ReceiverId");

                    b.HasIndex("ReplyToMessageId");

                    b.HasIndex("SenderId");

                    b.ToTable("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Emoji")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.HasIndex("MessageId", "UserId", "Emoji")
                        .IsUnique();

                    b.ToTable("MessageReactions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("ReadAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("MessageId", "UserId")
                        .IsUnique();

                    b.ToTable("MessageReads");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<bool>("IsReviewed")
                        .HasColumnType("bit");

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("ReviewedByAdminId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId");

                    b.HasIndex("UserId");

                    b.ToTable("MessageReports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("AllowMultipleAnswers")
                        .HasColumnType("bit");

                    b.Property<int?>("ChannelId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatorId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAnonymous")
                        .HasColumnType("bit");

                    b.Property<string>("Question")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("CreatorId");

                    b.HasIndex("GroupId");

                    b.ToTable("Polls");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<int>("PollId")
                        .HasColumnType("int");

                    b.Property<string>("Text")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("PollId");

                    b.ToTable("PollOptions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("PollOptionId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<DateTime>("VotedAt")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.HasIndex("PollOptionId", "UserId")
                        .IsUnique();

                    b.ToTable("PollVotes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AdminNote")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("ItemType")
                        .HasColumnType("int");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int?>("ReportedChannelId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedGroupId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedMessageId")
                        .HasColumnType("int");

                    b.Property<int?>("ReportedUserId")
                        .HasColumnType("int");

                    b.Property<int>("ReporterId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("ReviewedByAdminId")
                        .HasColumnType("bigint");

                    b.Property<int?>("ReviewedByAdminId1")
                        .HasColumnType("int");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ReportedChannelId");

                    b.HasIndex("ReportedGroupId");

                    b.HasIndex("ReportedMessageId");

                    b.HasIndex("ReportedUserId");

                    b.HasIndex("ReporterId");

                    b.HasIndex("ReviewedByAdminId1");

                    b.ToTable("Reports");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("CreatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Description")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("DisplayOrder")
                        .HasColumnType("int");

                    b.Property<string>("IconClass")
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("IconUrl")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("OpenInNewTab")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("Url")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.HasKey("Id");

                    b.HasIndex("CreatedByAdminId");

                    b.ToTable("ServiceLinks");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Amount")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<int?>("RelatedMessageId")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("RelatedMessageId");

                    b.HasIndex("UserId");

                    b.HasIndex("UserId1");

                    b.ToTable("SmsCreditLogs");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("MessageId")
                        .HasColumnType("int");

                    b.Property<DateTime>("StarredAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<int?>("UserId1")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MessageId");

                    b.HasIndex("UserId1");

                    b.HasIndex("UserId", "MessageId")
                        .IsUnique();

                    b.ToTable("StarredMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Content")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("nvarchar(2000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("SendImmediately")
                        .HasColumnType("bit");

                    b.Property<int>("SenderId")
                        .HasColumnType("int");

                    b.Property<bool>("ShowOnLogin")
                        .HasColumnType("bit");

                    b.Property<string>("Title")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.HasKey("Id");

                    b.HasIndex("SenderId");

                    b.ToTable("SystemNotifications");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Key")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int?>("UpdatedByAdminId")
                        .HasColumnType("int");

                    b.Property<string>("Value")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.HasKey("Id");

                    b.HasIndex("Key")
                        .IsUnique();

                    b.HasIndex("UpdatedByAdminId");

                    b.ToTable("SystemSettings");

                    b.HasData(
                        new
                        {
                            Id = 1,
                            Category = "General",
                            Description = "نوع احراز هویت: Database, ActiveDirectory, ERP",
                            Key = "AuthenticationType",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7031),
                            Value = "Database"
                        },
                        new
                        {
                            Id = 2,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند گروه ایجاد کنند",
                            Key = "AllowUserGroupCreation",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7045),
                            Value = "true"
                        },
                        new
                        {
                            Id = 3,
                            Category = "General",
                            Description = "آیا کاربران می‌توانند کانال ایجاد کنند",
                            Key = "AllowUserChannelCreation",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7047),
                            Value = "true"
                        },
                        new
                        {
                            Id = 4,
                            Category = "General",
                            Description = "زمان مجاز ویرایش پیام (ثانیه)",
                            Key = "MessageEditTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7048),
                            Value = "3600"
                        },
                        new
                        {
                            Id = 5,
                            Category = "General",
                            Description = "زمان مجاز حذف پیام (ثانیه)",
                            Key = "MessageDeleteTimeLimit",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7049),
                            Value = "7200"
                        },
                        new
                        {
                            Id = 6,
                            Category = "General",
                            Description = "فعال بودن تماس VoIP",
                            Key = "VoipEnabled",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7050),
                            Value = "true"
                        },
                        new
                        {
                            Id = 7,
                            Category = "General",
                            Description = "فعال بودن یکپارچگی تلگرام",
                            Key = "TelegramIntegrationEnabled",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7051),
                            Value = "false"
                        },
                        new
                        {
                            Id = 8,
                            Category = "General",
                            Description = "حداکثر تعداد اعضای گروه",
                            Key = "MaxGroupMembers",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7052),
                            Value = "200"
                        },
                        new
                        {
                            Id = 9,
                            Category = "General",
                            Description = "زمان انقضای کد OTP (دقیقه)",
                            Key = "OtpExpiryMinutes",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7053),
                            Value = "5"
                        },
                        new
                        {
                            Id = 10,
                            Category = "General",
                            Description = "نام سازمان",
                            Key = "CompanyName",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7054),
                            Value = "سازمان"
                        },
                        new
                        {
                            Id = 11,
                            Category = "General",
                            Description = "آدرس لوگوی سازمان",
                            Key = "CompanyLogoUrl",
                            UpdatedAt = new DateTime(2026, 2, 13, 15, 45, 24, 695, DateTimeKind.Local).AddTicks(7055),
                            Value = "/images/logo.png"
                        });
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("AttachmentUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Content")
                        .HasMaxLength(4000)
                        .HasColumnType("nvarchar(4000)");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsIncoming")
                        .HasColumnType("bit");

                    b.Property<bool>("IsRead")
                        .HasColumnType("bit");

                    b.Property<string>("TelegramChatId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<string>("TelegramUsername")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("TelegramChatId");

                    b.HasIndex("UserId");

                    b.ToTable("TelegramMessages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("ActiveDirectoryId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("AvatarUrl")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("Bio")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("BlockReason")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("BlockedAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVideoCall")
                        .HasColumnType("bit");

                    b.Property<bool>("CanMakeVoiceCall")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("ErpUserId")
                        .HasMaxLength(200)
                        .HasColumnType("nvarchar(200)");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("IsADAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsBlocked")
                        .HasColumnType("bit");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsErpAuthenticated")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOnline")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOtpVerified")
                        .HasColumnType("bit");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<DateTime?>("LastSeen")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("LastSeenAt")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("OtpCode")
                        .HasMaxLength(10)
                        .HasColumnType("nvarchar(10)");

                    b.Property<DateTime?>("OtpExpireTime")
                        .HasColumnType("datetime2");

                    b.Property<string>("PasswordHash")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PhoneNumber")
                        .HasMaxLength(20)
                        .HasColumnType("nvarchar(20)");

                    b.Property<string>("ProfilePicture")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<string>("PublicKey")
                        .HasMaxLength(1000)
                        .HasColumnType("nvarchar(1000)");

                    b.Property<string>("RefreshToken")
                        .HasMaxLength(500)
                        .HasColumnType("nvarchar(500)");

                    b.Property<DateTime?>("RefreshTokenExpiry")
                        .HasColumnType("datetime2");

                    b.Property<bool>("ShowPreview")
                        .HasColumnType("bit");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<bool>("SoundEnabled")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.Property<bool>("VoipEnabled")
                        .HasColumnType("bit");

                    b.Property<string>("VoipExtension")
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<string>("VoipPassword")
                        .HasMaxLength(100)
                        .HasColumnType("nvarchar(100)");

                    b.HasKey("Id");

                    b.HasIndex("PhoneNumber")
                        .IsUnique()
                        .HasFilter("[PhoneNumber] IS NOT NULL");

                    b.HasIndex("Username")
                        .IsUnique();

                    b.ToTable("Users");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanDeleteMessages")
                        .HasColumnType("bit");

                    b.Property<bool>("CanManageMembers")
                        .HasColumnType("bit");

                    b.Property<bool>("CanPost")
                        .HasColumnType("bit");

                    b.Property<int>("ChannelId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<bool>("IsOwner")
                        .HasColumnType("bit");

                    b.Property<bool>("IsPinned")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<long?>("LastReadMessageId")
                        .HasColumnType("bigint");

                    b.Property<DateTime?>("LeftAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<bool>("NotificationsEnabled")
                        .HasColumnType("bit");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UnreadCount")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("ChannelId");

                    b.HasIndex("UserId", "ChannelId")
                        .IsUnique();

                    b.ToTable("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("GroupId")
                        .HasColumnType("int");

                    b.Property<bool>("IsActive")
                        .HasColumnType("bit");

                    b.Property<bool>("IsAdmin")
                        .HasColumnType("bit");

                    b.Property<bool>("IsMuted")
                        .HasColumnType("bit");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("datetime2");

                    b.Property<DateTime?>("MutedUntil")
                        .HasColumnType("datetime2");

                    b.Property<int>("Role")
                        .HasColumnType("int");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("GroupId");

                    b.HasIndex("UserId", "GroupId")
                        .IsUnique();

                    b.ToTable("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("CanCreateChannel")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreateGroup")
                        .HasColumnType("bit");

                    b.Property<bool>("CanCreatePoll")
                        .HasColumnType("bit");

                    b.Property<bool>("CanSendBroadcast")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseTelegram")
                        .HasColumnType("bit");

                    b.Property<bool>("CanUseVoIP")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("SmsCredit")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditUsedThisYear")
                        .HasColumnType("int");

                    b.Property<int>("SmsCreditYear")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.Property<string>("VoIPExtension")
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("UserPermissions");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Calls")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Calls")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Initiator")
                        .WithMany("InitiatedCalls")
                        .HasForeignKey("InitiatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedCalls")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("Channel");

                    b.Navigation("Group");

                    b.Navigation("Initiator");

                    b.Navigation("Receiver");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedChannels")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.FileAttachment", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Attachments")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Uploader")
                        .WithMany("UploadedFiles")
                        .HasForeignKey("UploaderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("Uploader");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany("CreatedGroups")
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.GroupMember", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Members")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.LoginLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("LoginLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Call", "Call")
                        .WithMany("Messages")
                        .HasForeignKey("CallId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("Messages")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ForwardedFromMessage")
                        .WithMany()
                        .HasForeignKey("ForwardedFromMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("Messages")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Receiver")
                        .WithMany("ReceivedMessages")
                        .HasForeignKey("ReceiverId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReplyToMessage")
                        .WithMany("Replies")
                        .HasForeignKey("ReplyToMessageId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany("SentMessages")
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Call");

                    b.Navigation("Channel");

                    b.Navigation("ForwardedFromMessage");

                    b.Navigation("Group");

                    b.Navigation("Receiver");

                    b.Navigation("ReplyToMessage");

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReaction", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("Reactions")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("Reactions")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageRead", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany("ReadReceipts")
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.MessageReport", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("MessageReports")
                        .HasForeignKey("UserId");

                    b.Navigation("Message");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany()
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatorId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany()
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.Navigation("Channel");

                    b.Navigation("Creator");

                    b.Navigation("Group");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Poll", "Poll")
                        .WithMany("Options")
                        .HasForeignKey("PollId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Poll");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollVote", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.PollOption", "PollOption")
                        .WithMany("Votes")
                        .HasForeignKey("PollOptionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("PollOption");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Report", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "ReportedChannel")
                        .WithMany()
                        .HasForeignKey("ReportedChannelId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "ReportedGroup")
                        .WithMany()
                        .HasForeignKey("ReportedGroupId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "ReportedMessage")
                        .WithMany()
                        .HasForeignKey("ReportedMessageId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReportedUser")
                        .WithMany()
                        .HasForeignKey("ReportedUserId");

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Reporter")
                        .WithMany()
                        .HasForeignKey("ReporterId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "ReviewedByAdmin")
                        .WithMany()
                        .HasForeignKey("ReviewedByAdminId1");

                    b.Navigation("ReportedChannel");

                    b.Navigation("ReportedGroup");

                    b.Navigation("ReportedMessage");

                    b.Navigation("ReportedUser");

                    b.Navigation("Reporter");

                    b.Navigation("ReviewedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.ServiceLink", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "CreatedByAdmin")
                        .WithMany()
                        .HasForeignKey("CreatedByAdminId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CreatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SmsCreditLog", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "RelatedMessage")
                        .WithMany()
                        .HasForeignKey("RelatedMessageId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("SmsCreditLogs")
                        .HasForeignKey("UserId1");

                    b.Navigation("RelatedMessage");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.StarredMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Message", "Message")
                        .WithMany()
                        .HasForeignKey("MessageId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", null)
                        .WithMany("StarredMessages")
                        .HasForeignKey("UserId1");

                    b.Navigation("Message");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemNotification", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "Sender")
                        .WithMany()
                        .HasForeignKey("SenderId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Sender");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.SystemSetting", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.AdminUser", "UpdatedByAdmin")
                        .WithMany()
                        .HasForeignKey("UpdatedByAdminId");

                    b.Navigation("UpdatedByAdmin");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.TelegramMessage", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserChannel", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Channel", "Channel")
                        .WithMany("UserChannels")
                        .HasForeignKey("ChannelId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserChannels")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Channel");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserGroup", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.Group", "Group")
                        .WithMany("UserGroups")
                        .HasForeignKey("GroupId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany("UserGroups")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Group");

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.UserPermission", b =>
                {
                    b.HasOne("OrganizationalMessenger.Domain.Entities.User", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Call", b =>
                {
                    b.Navigation("Messages");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Channel", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Messages");

                    b.Navigation("UserChannels");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Group", b =>
                {
                    b.Navigation("Calls");

                    b.Navigation("Members");

                    b.Navigation("Messages");

                    b.Navigation("UserGroups");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Message", b =>
                {
                    b.Navigation("Attachments");

                    b.Navigation("Reactions");

                    b.Navigation("ReadReceipts");

                    b.Navigation("Replies");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.Poll", b =>
                {
                    b.Navigation("Options");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.PollOption", b =>
                {
                    b.Navigation("Votes");
                });

            modelBuilder.Entity("OrganizationalMessenger.Domain.Entities.User", b =>
                {
                    b.Navigation("CreatedChannels");

                    b.Navigation("CreatedGroups");

                    b.Navigation("InitiatedCalls");

                    b.Navigation("LoginLogs");

                    b.Navigation("MessageReports");

                    b.Navigation("Reactions");

                    b.Navigation("ReceivedCalls");

                    b.Navigation("ReceivedMessages");

                    b.Navigation("SentMessages");

                    b.Navigation("SmsCreditLogs");

                    b.Navigation("StarredMessages");

                    b.Navigation("UploadedFiles");

                    b.Navigation("UserChannels");

                    b.Navigation("UserGroups");
                });
#pragma warning restore 612, 618
        }
    }
}
 
 
